(function(n){"use strict";Date.now||(Date.now=function(){return(new Date).getTime()});Math.trunc||(Math.trunc=function(n){return n<0?Math.ceil(n):Math.floor(n)});Object.setPrototypeOf||(Object.setPrototypeOf=function(n,t){return n.__proto__=t,n});n.WebSharper={Runtime:{Ctor:function(n,t){return n.prototype=t.prototype,n},Class:function(n,t,i){var u=n,f,r,e;if(t){u=new t;for(f in n)u[f]=n[f]}if(r=function(n){if(n)for(var t in n)this[t]=n[t]},r.prototype=u,i)for(e in i)r[e]=i[e];return r},Clone:function(n){var t={};for(var i of Object.getOwnPropertyNames(n))t[i]=n[i];return Object.setPrototypeOf(t,Object.getPrototypeOf(n)),t},NewObject:function(n){for(var i={},t=0;t<n.length;t++)i[n[t][0]]=n[t][1];return i},PrintObject:function(n){var t="{ ",i=!0;for(var r of Object.getOwnPropertyNames(n))i?i=!1:t+=", ",t+=r+" = "+n[r];return t+(i?"}":" }")},DeleteEmptyFields:function(n,t){for(var r,i=0;i<t.length;i++)r=t[i],n[r]===void 0&&delete n[r];return n},GetOptional:function(n){return n===void 0?null:{$:1,$0:n}},SetOptional:function(n,t,i){i?n[t]=i.$0:delete n[t]},SetOrDelete:function(n,t,i){i===void 0?delete n[t]:n[t]=i},Apply:function(n,t,i){return n.apply(t,i)},Bind:function(n){return function(){return n.apply(this,arguments)}},CreateFuncWithArgs:function(n){return function(){return n(Array.prototype.slice.call(arguments))}},CreateFuncWithOnlyThis:function(n){return function(){return n(this)}},CreateFuncWithThis:function(n){return function(){return n(this).apply(null,arguments)}},CreateFuncWithThisArgs:function(n){return function(){return n(this)(Array.prototype.slice.call(arguments))}},CreateFuncWithRest:function(n,t){return function(){return t(Array.prototype.slice.call(arguments,0,n).concat([Array.prototype.slice.call(arguments,n)]))}},CreateFuncWithArgsRest:function(n,t){return function(){return t([Array.prototype.slice.call(arguments,0,n),Array.prototype.slice.call(arguments,n)])}},BindDelegate:function(n,t){var i=n.bind(t);return i.$Func=n,i.$Target=t,i},CreateDelegate:function(n){if(n.length==0)return null;if(n.length==1)return n[0];var t=function(){for(var i,t=0;t<n.length;t++)i=n[t].apply(null,arguments);return i};return t.$Invokes=n,t},CombineDelegates:function(n){for(var t,i=[],r=0;r<n.length;r++)t=n[r],t&&("$Invokes"in t?i=i.concat(t.$Invokes):i.push(t));return WebSharper.Runtime.CreateDelegate(i)},DelegateEqual:function(n,t){var f,e,i,r,u;if(n===t)return!0;if(n==null||t==null||(f=n.$Invokes||[n],e=t.$Invokes||[t],f.length!=e.length))return!1;for(i=0;i<f.length;i++)if(r=f[i],u=e[i],!(r===u||"$Func"in r&&"$Func"in u&&r.$Func===u.$Func&&r.$Target==u.$Target))return!1;return!0},ThisFunc:function(n){return function(){var t=Array.prototype.slice.call(arguments);return t.unshift(this),n.apply(null,t)}},ThisFuncOut:function(n){return function(){var t=Array.prototype.slice.call(arguments);return n.apply(t.shift(),t)}},ParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat([i.slice(n)]))}},ParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat(i[n]))}},ThisParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return i.unshift(this),t.apply(null,i.slice(0,n+1).concat([i.slice(n+1)]))}},ThisParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(i.shift(),i.slice(0,n).concat(i[n]))}},Curried:function(n,t,i){return i=i||[],function(r){var u=i.concat([r===void 0?null:r]);return t==1?n.apply(null,u):t==2?function(t){return n.apply(null,u.concat([t===void 0?null:t]))}:WebSharper.Runtime.Curried(n,t-1,u)}},Curried2:function(n){return function(t){return function(i){return n(t,i)}}},Curried3:function(n){return function(t){return function(i){return function(r){return n(t,i,r)}}}},UnionByType:function(n,t,i){for(var u,f=typeof t,r=0;r<n.length;r++)if(u=n[r],typeof u=="number"){if(Array.isArray(t)&&(u==0||t.length==u))return{$:r,$0:t}}else if(u==f)return{$:r,$0:t};if(!i)throw new Error("Type not expected for creating Choice value.");},MarkResizable:function(n){return Object.defineProperty(n,"resizable",{enumerable:!1,writable:!1,configurable:!1,value:!0}),n},MarkReadOnly:function(n){return Object.defineProperty(n,"readonly",{enumerable:!1,writable:!1,configurable:!1,value:!0}),n},ScriptBasePath:"./",ScriptPath:function(n,t){return this.ScriptBasePath+(this.ScriptSkipAssemblyDir?"":n+"/")+t},OnLoad:function(n){"load"in this||(this.load=[]);this.load.push(n)},Start:function(){function n(n){for(var t=0;t<n.length;t++)n[t]()}"load"in this&&(n(this.load),this.load=[])}}};n.WebSharper.Runtime.OnLoad(function(){n.WebSharper&&WebSharper.Activator&&WebSharper.Activator.Activate&&WebSharper.Activator.Activate()});n.ignore=function(){};n.id=function(n){return n};n.fst=function(n){return n[0]};n.snd=function(n){return n[1]};n.trd=function(n){return n[2]};n.console||(n.console={count:ignore,dir:ignore,error:ignore,group:ignore,groupEnd:ignore,info:ignore,log:ignore,profile:ignore,profileEnd:ignore,time:ignore,timeEnd:ignore,trace:ignore,warn:ignore})})(self);
(function(){for(var i=0,t=["webkit","moz"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(n){var t=(new Date).getTime(),r=Math.max(0,16-(t-i)),u=window.setTimeout(function(){n(t+r)},r);return i=t+r,u});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(n){clearTimeout(n)})})();
/* https://github.com/jonathantneal/closest */
(function(w,p){p=w.Element.prototype
if(!p.matches){p.matches=p.msMatchesSelector||function(s){var m=(this.document||this.ownerDocument).querySelectorAll(s);for(var i=0;m[i]&&m[i]!==e;++i);return!!m[i]}}
if(!p.closest){p.closest=function(s){var e=this;while(e&&e.nodeType==1){if(e.matches(s))return e;e=e.parentNode}return null}}})(self);
(function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_,$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU;b=a.WebSharper=a.WebSharper||{};c=b.Obj=b.Obj||{};d=a.Cs=a.Cs||{};e=d.Spa=d.Spa||{};f=e.App=e.App||{};g=b.UI=b.UI||{};h=g.ListModel=g.ListModel||{};i=g.Var$1=g.Var$1||{};j=e.Template=e.Template||{};k=j.Index=j.Index||{};l=k.Main=k.Main||{};m=k.ListItem=k.ListItem||{};n=g.Var=g.Var||{};o=b.Operators=b.Operators||{};p=g.ConcreteVar=g.ConcreteVar||{};q=g.Snap=g.Snap||{};r=g.Doc=g.Doc||{};s=b.JavaScript=b.JavaScript||{};t=s.Pervasives=s.Pervasives||{};u=g.Templating=g.Templating||{};v=u.Runtime=u.Runtime||{};w=v.Server=v.Server||{};x=w.TemplateInstance=w.TemplateInstance||{};y=g.Storage=g.Storage||{};z=b.Seq=b.Seq||{};A=g.Abbrev=g.Abbrev||{};B=A.Fresh=A.Fresh||{};C=a.EventTarget;D=a.Node;E=b.Unchecked=b.Unchecked||{};F=l.Instance=l.Instance||{};G=w.Handler=w.Handler||{};H=a.Cs$Spa_Templates=a.Cs$Spa_Templates||{};I=a.Object;J=a.System=a.System||{};K=J.Guid=J.Guid||{};L=g.View=g.View||{};M=b.Collections=b.Collections||{};N=M.Dictionary=M.Dictionary||{};O=m.Instance=m.Instance||{};P=b.Arrays=b.Arrays||{};Q=y.ArrayStorage=y.ArrayStorage||{};R=b.Numeric=b.Numeric||{};S=a.WindowOrWorkerGlobalScope;T=g.Docs=g.Docs||{};U=g.AttrProxy=g.AttrProxy||{};V=g.CheckedInput=g.CheckedInput||{};W=M.HashSet=M.HashSet||{};X=w.TemplateInitializer=w.TemplateInitializer||{};Y=b.List=b.List||{};Z=Y.T=Y.T||{};_0=b.Enumerator=b.Enumerator||{};_1=a.StartupCode$WebSharper_UI$Abbrev=a.StartupCode$WebSharper_UI$Abbrev||{};_2=g.DocElemNode=g.DocElemNode||{};_3=a.CharacterData;_4=g.DomUtility=g.DomUtility||{};_5=g.An=g.An||{};_6=g.Client=g.Client||{};_7=_6.Settings=_6.Settings||{};_8=A.Mailbox=A.Mailbox||{};_9=M.DictionaryUtil=M.DictionaryUtil||{};_=_0.T=_0.T||{};$=_6.Templates=_6.Templates||{};ba=_6.Attrs=_6.Attrs||{};bb=ba.Dyn=ba.Dyn||{};bc=_6.Docs=_6.Docs||{};bd=bc.RunState=bc.RunState||{};be=bc.NodeSet=bc.NodeSet||{};bf=b.Concurrency=b.Concurrency||{};bg=g.Anims=g.Anims||{};bh=a.StartupCode$WebSharper_UI$Doc_Proxy=a.StartupCode$WebSharper_UI$Doc_Proxy||{};bi=g.Array=g.Array||{};bj=g.Attrs=g.Attrs||{};bk=a.StartupCode$WebSharper_UI$Animation=a.StartupCode$WebSharper_UI$Animation||{};bl=g.AppendList=g.AppendList||{};bm=a.StartupCode$WebSharper_UI$Templates=a.StartupCode$WebSharper_UI$Templates||{};bn=g.Elt=g.Elt||{};bo=a.StartupCode$WebSharper_UI$Attr_Client=a.StartupCode$WebSharper_UI$Attr_Client||{};bp=bf.Scheduler=bf.Scheduler||{};bq=g.Easing=g.Easing||{};br=bf.AsyncBody=bf.AsyncBody||{};bs=a.StartupCode$WebSharper_Main$Concurrency=a.StartupCode$WebSharper_Main$Concurrency||{};bt=bf.CT=bf.CT||{};bu=A.HashSet=A.HashSet||{};bv=$.Prepare=$.Prepare||{};bw=b.Slice=b.Slice||{};bx=M.KeyCollection=M.KeyCollection||{};by=g.AttrModule=g.AttrModule||{};bz=b.Strings=b.Strings||{};bA=g.Updates=g.Updates||{};bB=M.ValueCollection=M.ValueCollection||{};bC=g.BindVar=g.BindVar||{};bD=g.String=g.String||{};bE=b.CancellationTokenSource=b.CancellationTokenSource||{};bF=bc.DomNodes=bc.DomNodes||{};bG=b.Char=b.Char||{};bH=a.Error;bI=b.OperationCanceledException=b.OperationCanceledException||{};bJ=b.Lazy=b.Lazy||{};bK=M.HashSetUtil=M.HashSetUtil||{};bL=a.StartupCode$WebSharper_UI$AppendList=a.StartupCode$WebSharper_UI$AppendList||{};bM=a.StartupCode$WebSharper_UI$DomUtility=a.StartupCode$WebSharper_UI$DomUtility||{};bN=g.DynamicAttrNode=g.DynamicAttrNode||{};bO=b.Queue=b.Queue||{};bP=b.LazyExtensionsProxy=b.LazyExtensionsProxy||{};bQ=bP.LazyRecord=bP.LazyRecord||{};bR=b&&b.Runtime;bS=a.console;bT=a.Math;bU=a.Date;c=b.Obj=bR.Class({Equals:function(bV){return this===bV;},GetHashCode:function(){return -1;}},null,c);c.New=bR.Ctor(function(){},c);f=e.App=bR.Class({},c,f);f.ClientMain=function(){var bV,bW;bV=h.FromSeq(["John","Paul"]);bW=i.Create$1("");r.RunById("main",(new l.New()).ListContainer$4(r.Convert(function(bX){return(new m.New()).Name$1(bX).Doc();},bV.v)).Name(bW).Add$1(function(){bV.Append(bW.Get());bW.Set("");}).Doc());};h.FromSeq=function(bV){return h.Create(a.id,bV);};h.Create=function(bV,bW){return h.CreateWithStorage(bV,y.InMemory(P.ofSeq(bW)));};h.CreateWithStorage=function(bV,bW){return new h.New(bV,bW);};i=g.Var$1=bR.Class({},c,i);i.Create$1=function(bV){return new p.New(false,q.New({$:2,$0:bV,$1:[]}),bV);};l=k.Main=bR.Class({Doc:function(){return this.Create().get_Doc();},Add$1:function(bV){function bW(bX,bY){return bV();}this.holes.push({$:4,$0:"add",$1:function(bX){return function(bY){return bW(bX,bY);};}});return this;},Name:function(bV){this.holes.push({$:8,$0:"name",$1:bV});return this;},ListContainer$4:function(bV){this.holes.push({$:0,$0:"listcontainer",$1:bV});return this;},Create:function(){var bV,bW;bV=G.CompleteHoles(this.key,this.holes,[["name",0]]);bW=H.main(bV[0]);this.instance=new F.New(bV[1],bW);return this.instance;},$init:function(){this.key=K.NewGuid();this.holes=bR.MarkResizable([]);this.instance=null;}},c,l);l.New=bR.Ctor(function(){this.$init();},l);h=g.ListModel=bR.Class({Append:function(bV){var bW,bX,bY,bZ;bW=this;bX=this["var"].Get();bY=this.key(bV);bZ=P.tryFindIndex(function(b0){return E.Equals(bW.key(b0),bY);},bX);if(bZ!=null&&bZ.$==1)this["var"].Set(this.storage.SSetAt(bZ.$0,bV,bX));else this["var"].Set(this.storage.SAppend(bV,bX));this.ObsoleteKey(bY);},ObsoleteKey:function(bV){var bW,bX;bW=(bX=null,[this.it.TryGetValue(bV,{get:function(){return bX;},set:function(bY){bX=bY;}}),bX]);if(bW[0]){q.Obsolete(bW[1]);this.it.RemoveKey(bV);}},GetEnumerator:function(){return _0.Get(this["var"].Get());}},c,h);h.New=bR.Ctor(function(bV,bW){h.New$3.call(this,bV,i.Create$1(P.ofSeq(z.distinctBy(bV,bW.SInit()))),bW);},h);h.New$3=bR.Ctor(function(bV,bW,bX){c.New.call(this);this.key=bV;this["var"]=bW;this.storage=bX;this.v=L.Map(function(bY){return bY.slice();},this["var"].get_View());this.it=new N.New$5();},h);m=k.ListItem=bR.Class({Doc:function(){return this.Create().get_Doc();},Name$1:function(bV){this.holes.push({$:1,$0:"name",$1:bV});return this;},Create:function(){var bV,bW;bV=G.CompleteHoles(this.key,this.holes,[]);bW=H.listitem(bV[0]);this.instance=new O.New(bV[1],bW);return this.instance;},$init:function(){this.key=K.NewGuid();this.holes=bR.MarkResizable([]);this.instance=null;}},c,m);m.New=bR.Ctor(function(){this.$init();},m);n=g.Var=bR.Class({},c,n);n.New=bR.Ctor(function(){c.New.call(this);},n);o.FailWith=function(bV){throw new bH(bV);};o.KeyValue=function(bV){return[bV.K,bV.V];};p=g.ConcreteVar=bR.Class({Get:function(){return this.current;},Set:function(bV){if(this.isConst)(function(bW){return bW("WebSharper.UI: invalid attempt to change value of a Var after calling SetFinal");}(function(bW){bS.log(bW);}));else{q.Obsolete(this.snap);this.current=bV;this.snap=q.New({$:2,$0:bV,$1:[]});}},get_View:function(){return this.view;},UpdateMaybe:function(bV){var bW;bW=bV(this.Get());if(bW!=null&&bW.$==1)this.Set(bW.$0);}},n,p);p.New=bR.Ctor(function(bV,bW,bX){var bY;bY=this;n.New.call(this);this.isConst=bV;this.current=bX;this.snap=bW;this.view=function(){return bY.snap;};this.id=B.Int();},p);q.WhenRun=function(bV,bW,bX){var bY;bY=bV.s;if(bY==null)bX();else bY!=null&&bY.$==2?(bY.$1.push(bX),bW(bY.$0)):bY!=null&&bY.$==3?(bY.$0.push(bW),bY.$1.push(bX)):bW(bY.$0);};q.Map=function(bV,bW){var bX,bY;bX=bW.s;return bX!=null&&bX.$==0?q.New({$:0,$0:bV(bX.$0)}):(bY=q.New({$:3,$0:[],$1:[]}),(q.When(bW,function(bZ){q.MarkDone(bY,bW,bV(bZ));},bY),bY));};q.WhenObsoleteRun=function(bV,bW){var bX;bX=bV.s;if(bX==null)bW();else bX!=null&&bX.$==2?bX.$1.push(bW):bX!=null&&bX.$==3?bX.$1.push(bW):void 0;};q.When=function(bV,bW,bX){var bY;bY=bV.s;if(bY==null)q.Obsolete(bX);else bY!=null&&bY.$==2?(q.EnqueueSafe(bY.$1,bX),bW(bY.$0)):bY!=null&&bY.$==3?(bY.$0.push(bW),q.EnqueueSafe(bY.$1,bX)):bW(bY.$0);};q.MarkDone=function(bV,bW,bX){var bY;if(bY=bW.s,bY!=null&&bY.$==0)q.MarkForever(bV,bX);else q.MarkReady(bV,bX);};q.EnqueueSafe=function(bV,bW){var bX,bY,bZ,b0;bV.push(bW);if(bV.length%20===0){bX=bV.slice(0);bO.Clear(bV);for(bY=0,bZ=P.length(bX)-1;bY<=bZ;bY++){b0=P.get(bX,bY);if(typeof b0=="object")(function(b1){if(b1.s)bV.push(b1);}(b0));else(function(b1){bV.push(b1);}(b0));}}else void 0;};q.MarkForever=function(bV,bW){var bX,bY,bZ,b0;bX=bV.s;if(bX!=null&&bX.$==3){bV.s={$:0,$0:bW};bY=bX.$0;for(bZ=0,b0=P.length(bY)-1;bZ<=b0;bZ++)(P.get(bY,bZ))(bW);}else void 0;};q.MarkReady=function(bV,bW){var bX,bY,bZ,b0;bX=bV.s;if(bX!=null&&bX.$==3){bV.s={$:2,$0:bW,$1:bX.$1};bY=bX.$0;for(bZ=0,b0=P.length(bY)-1;bZ<=b0;bZ++)(P.get(bY,bZ))(bW);}else void 0;};q.Map2Unit=function(bV,bW){var bX,bY,bZ;function b0(){var b1,b2,b3;if(!(b1=bZ.s,b1!=null&&b1.$==0||b1!=null&&b1.$==2)){b2=q.ValueAndForever(bV);b3=q.ValueAndForever(bW);if(b2!=null&&b2.$==1)b3!=null&&b3.$==1?b2.$0[1]&&b3.$0[1]?q.MarkForever(bZ,null):q.MarkReady(bZ,null):void 0;}}bX=bV.s;bY=bW.s;return bX!=null&&bX.$==0?bY!=null&&bY.$==0?q.New({$:0,$0:null}):bW:bY!=null&&bY.$==0?bV:(bZ=q.New({$:3,$0:[],$1:[]}),(q.When(bV,b0,bZ),q.When(bW,b0,bZ),bZ));};q.Join=function(bV){var bW;bW=q.New({$:3,$0:[],$1:[]});q.When(bV,function(bX){var bY;bY=bX();q.When(bY,function(bZ){var b0,b1;if((b0=bY.s,b0!=null&&b0.$==0)&&(b1=bV.s,b1!=null&&b1.$==0))q.MarkForever(bW,bZ);else q.MarkReady(bW,bZ);},bW);},bW);return bW;};q.Map3=function(bV,bW,bX,bY){var bZ,b0,b1,b2;function b3(b4){var b5,b6,b7,b8;if(!(b5=b2.s,b5!=null&&b5.$==0||b5!=null&&b5.$==2)){b6=q.ValueAndForever(bW);b7=q.ValueAndForever(bX);b8=q.ValueAndForever(bY);if(b6!=null&&b6.$==1)b7!=null&&b7.$==1?b8!=null&&b8.$==1?b6.$0[1]&&b7.$0[1]&&b8.$0[1]?q.MarkForever(b2,bV(b6.$0[0],b7.$0[0],b8.$0[0])):q.MarkReady(b2,bV(b6.$0[0],b7.$0[0],b8.$0[0])):void 0:void 0;}}bZ=bW.s;b0=bX.s;b1=bY.s;return bZ!=null&&bZ.$==0?b0!=null&&b0.$==0?b1!=null&&b1.$==0?q.New({$:0,$0:bV(bZ.$0,b0.$0,b1.$0)}):q.Map3Opt1(bV,bZ.$0,b0.$0,bY):b1!=null&&b1.$==0?q.Map3Opt2(bV,bZ.$0,b1.$0,bX):q.Map3Opt3(bV,bZ.$0,bX,bY):b0!=null&&b0.$==0?b1!=null&&b1.$==0?q.Map3Opt4(bV,b0.$0,b1.$0,bW):q.Map3Opt5(bV,b0.$0,bW,bY):b1!=null&&b1.$==0?q.Map3Opt6(bV,b1.$0,bW,bX):(b2=q.New({$:3,$0:[],$1:[]}),(q.When(bW,b3,b2),q.When(bX,b3,b2),q.When(bY,b3,b2),b2));};q.Sequence=function(bV){var bW,bX,bY;function bZ(b0){var b1;if(bY[0]===0){b1=P.map(function(b2){var b3;b3=b2.s;return b3!=null&&b3.$==0?b3.$0:b3!=null&&b3.$==2?b3.$0:o.FailWith("value not found by View.Sequence");},bW);if(P.forall(function(b2){var b3;b3=b2.s;return b3!=null&&b3.$==0;},bW))q.MarkForever(bX,b1);else q.MarkReady(bX,b1);}else bY[0]=bY[0]-1;}bW=P.ofSeq(bV);return bW.length==0?q.New({$:0,$0:[]}):(bX=q.New({$:3,$0:[],$1:[]}),(bY=[P.length(bW)-1],(P.iter(function(b0){q.When(b0,bZ,bX);},bW),bX)));};q.Map2=function(bV,bW,bX){var bY,bZ,b0;function b1(b2){var b3,b4,b5;if(!(b3=b0.s,b3!=null&&b3.$==0||b3!=null&&b3.$==2)){b4=q.ValueAndForever(bW);b5=q.ValueAndForever(bX);if(b4!=null&&b4.$==1)b5!=null&&b5.$==1?b4.$0[1]&&b5.$0[1]?q.MarkForever(b0,bV(b4.$0[0],b5.$0[0])):q.MarkReady(b0,bV(b4.$0[0],b5.$0[0])):void 0;}}bY=bW.s;bZ=bX.s;return bY!=null&&bY.$==0?bZ!=null&&bZ.$==0?q.New({$:0,$0:bV(bY.$0,bZ.$0)}):q.Map2Opt1(bV,bY.$0,bX):bZ!=null&&bZ.$==0?q.Map2Opt2(bV,bZ.$0,bW):(b0=q.New({$:3,$0:[],$1:[]}),(q.When(bW,b1,b0),q.When(bX,b1,b0),b0));};q.Copy=function(bV){var bW,bX,bY;bW=bV.s;return bW==null?bV:bW!=null&&bW.$==2?(bX=q.New({$:2,$0:bW.$0,$1:[]}),(q.WhenObsolete(bV,bX),bX)):bW!=null&&bW.$==3?(bY=q.New({$:3,$0:[],$1:[]}),(q.When(bV,function(bZ){q.MarkDone(bY,bV,bZ);},bY),bY)):bV;};q.ValueAndForever=function(bV){var bW;bW=bV.s;return bW!=null&&bW.$==0?{$:1,$0:[bW.$0,true]}:bW!=null&&bW.$==2?{$:1,$0:[bW.$0,false]}:null;};q.Map3Opt1=function(bV,bW,bX,bY){return q.Map(function(bZ){return bV(bW,bX,bZ);},bY);};q.Map3Opt2=function(bV,bW,bX,bY){return q.Map(function(bZ){return bV(bW,bZ,bX);},bY);};q.Map3Opt3=function(bV,bW,bX,bY){return q.Map2(function(bZ,b0){return bV(bW,bZ,b0);},bX,bY);};q.Map3Opt4=function(bV,bW,bX,bY){return q.Map(function(bZ){return bV(bZ,bW,bX);},bY);};q.Map3Opt5=function(bV,bW,bX,bY){return q.Map2(function(bZ,b0){return bV(bZ,bW,b0);},bX,bY);};q.Map3Opt6=function(bV,bW,bX,bY){return q.Map2(function(bZ,b0){return bV(bZ,b0,bW);},bX,bY);};q.Map2Opt1=function(bV,bW,bX){return q.Map(function(bY){return bV(bW,bY);},bX);};q.Map2Opt2=function(bV,bW,bX){return q.Map(function(bY){return bV(bY,bW);},bX);};q.WhenObsolete=function(bV,bW){var bX;bX=bV.s;if(bX==null)q.Obsolete(bW);else bX!=null&&bX.$==2?q.EnqueueSafe(bX.$1,bW):bX!=null&&bX.$==3?q.EnqueueSafe(bX.$1,bW):void 0;};r=g.Doc=bR.Class({},c,r);r.RunById=function(bV,bW){var bX;bX=self.document.getElementById(bV);if(E.Equals(bX,null))o.FailWith("invalid id: "+bV);else r.Run(bX,bW);};r.Run=function(bV,bW){T.LinkElement(bV,bW.docNode);r.RunInPlace(false,bV,bW);};r.Convert=function(bV,bW){return r.Flatten(L.MapSeqCached(bV,bW));};r.RunInPlace=function(bV,bW,bX){var bY;bY=T.CreateRunState(bW,bX.docNode);L.Sink(_5.get_UseAnimations()||_7.BatchUpdatesEnabled()?_8.StartProcessor(T.PerformAnimatedUpdate(bV,bY,bX.docNode)):function(){T.PerformSyncUpdate(bV,bY,bX.docNode);},bX.updates);};r.Flatten=function(bV){return r.EmbedView(L.Map(r.Concat,bV));};r.Concat=function(bV){var bW;bW=bi.ofSeqNonCopying(bV);return bi.TreeReduce(r.get_Empty(),r.Append,bW);};r.EmbedView=function(bV){var bW;bW=T.CreateEmbedNode();return r.Mk({$:2,$0:bW},L.Map(a.ignore,L.Bind(function(bX){T.UpdateEmbedNode(bW,bX.docNode);return bX.updates;},bV)));};r.get_Empty=function(){return r.Mk(null,L.Const());};r.Append=function(bV,bW){return r.Mk({$:0,$0:bV.docNode,$1:bW.docNode},L.Map2Unit(bV.updates,bW.updates));};r.Mk=function(bV,bW){return new r.New(bV,bW);};r.TextNode=function(bV){return r.Mk({$:5,$0:self.document.createTextNode(bV)},L.Const());};r.TextView=function(bV){var bW;bW=T.CreateTextNode();return r.Mk({$:4,$0:bW},L.Map(function(bX){T.UpdateTextNode(bW,bX);},bV));};r.New=bR.Ctor(function(bV,bW){c.New.call(this);this.docNode=bV;this.updates=bW;},r);t.NewFromSeq=function(bV){var bW,bX,bY;bW={};bX=_0.Get(bV);try{while(bX.MoveNext()){bY=bX.Current();bW[bY[0]]=bY[1];}}finally{if(typeof bX=="object"&&"Dispose"in bX)bX.Dispose();}return bW;};x=w.TemplateInstance=bR.Class({get_Doc:function(){return this.doc;}},c,x);x.New=bR.Ctor(function(bV,bW){c.New.call(this);this.doc=bW;this.allVars=bV.$==0?bV.$0:o.FailWith("Should not happen");},x);y.InMemory=function(bV){return new Q.New(bV);};z.append=function(bV,bW){return{GetEnumerator:function(){var bX,bY;bX=_0.Get(bV);bY=[true];return new _.New(bX,null,function(bZ){var b0;return bZ.s.MoveNext()?(bZ.c=bZ.s.Current(),true):(b0=bZ.s,!E.Equals(b0,null)?b0.Dispose():void 0,bZ.s=null,bY[0]&&(bY[0]=false,bZ.s=_0.Get(bW),bZ.s.MoveNext()?(bZ.c=bZ.s.Current(),true):(bZ.s.Dispose(),bZ.s=null,false)));},function(bZ){var b0;b0=bZ.s;if(!E.Equals(b0,null))b0.Dispose();});}};};z.distinctBy=function(bV,bW){return{GetEnumerator:function(){var bX,bY;bX=_0.Get(bW);bY=new W.New$3();return new _.New(null,null,function(bZ){var b0,b1;if(bX.MoveNext()){b0=bX.Current();b1=bY.SAdd(bV(b0));while(!b1&&bX.MoveNext()){b0=bX.Current();b1=bY.SAdd(bV(b0));}return b1&&(bZ.c=b0,true);}else return false;},function(){bX.Dispose();});}};};z.head=function(bV){var bW;bW=_0.Get(bV);try{return bW.MoveNext()?bW.Current():z.insufficient();}finally{if(typeof bW=="object"&&"Dispose"in bW)bW.Dispose();}};z.iter=function(bV,bW){var bX;bX=_0.Get(bW);try{while(bX.MoveNext())bV(bX.Current());}finally{if(typeof bX=="object"&&"Dispose"in bX)bX.Dispose();}};z.map=function(bV,bW){return{GetEnumerator:function(){var bX;bX=_0.Get(bW);return new _.New(null,null,function(bY){return bX.MoveNext()&&(bY.c=bV(bX.Current()),true);},function(){bX.Dispose();});}};};z.max=function(bV){var bW,bX,bY;bW=_0.Get(bV);try{if(!bW.MoveNext())z.seqEmpty();bX=bW.Current();while(bW.MoveNext()){bY=bW.Current();if(E.Compare(bY,bX)===1)bX=bY;}return bX;}finally{if(typeof bW=="object"&&"Dispose"in bW)bW.Dispose();}};z.fold=function(bV,bW,bX){var bY,bZ;bY=bW;bZ=_0.Get(bX);try{while(bZ.MoveNext())bY=bV(bY,bZ.Current());return bY;}finally{if(typeof bZ=="object"&&"Dispose"in bZ)bZ.Dispose();}};z.seqEmpty=function(){return o.FailWith("The input sequence was empty.");};z.forall=function(bV,bW){return!z.exists(function(bX){return!bV(bX);},bW);};z.exists=function(bV,bW){var bX,bY;bX=_0.Get(bW);try{bY=false;while(!bY&&bX.MoveNext())bY=bV(bX.Current());return bY;}finally{if(typeof bX=="object"&&"Dispose"in bX)bX.Dispose();}};B.Int=function(){B.set_counter(B.counter()+1);return B.counter();};B.set_counter=function(bV){_1.$cctor();_1.counter=bV;};B.counter=function(){_1.$cctor();return _1.counter;};E.Equals=function(bV,bW){var bX,bY,bZ,b0;if(bV===bW)return true;else{bX=typeof bV;if(bX=="object"){if(bV===null||bV===void 0||bW===null||bW===void 0||!E.Equals(typeof bW,"object"))return false;else if("Equals"in bV)return bV.Equals(bW);else if("Equals"in bW)return false;else if(bV instanceof a.Array&&bW instanceof a.Array)return E.arrayEquals(bV,bW);else if(bV instanceof a.Date&&bW instanceof a.Date)return E.dateEquals(bV,bW);else{bY=[true];for(var b1 in bV)if(function(b2){bY[0]=!bV.hasOwnProperty(b2)||bW.hasOwnProperty(b2)&&E.Equals(bV[b2],bW[b2]);return!bY[0];}(b1))break;if(bY[0]){for(var b2 in bW)if(function(b3){bY[0]=!bW.hasOwnProperty(b3)||bV.hasOwnProperty(b3);return!bY[0];}(b2))break;}return bY[0];}}else return bX=="function"&&("$Func"in bV?bV.$Func===bW.$Func&&bV.$Target===bW.$Target:"$Invokes"in bV&&"$Invokes"in bW&&E.arrayEquals(bV.$Invokes,bW.$Invokes));}};E.arrayEquals=function(bV,bW){var bX,bY;if(P.length(bV)===P.length(bW)){bX=true;bY=0;while(bX&&bY<P.length(bV)){!E.Equals(P.get(bV,bY),P.get(bW,bY))?bX=false:void 0;bY=bY+1;}return bX;}else return false;};E.dateEquals=function(bV,bW){return bV.getTime()===bW.getTime();};E.Hash=function(bV){var bW;bW=typeof bV;return bW=="function"?0:bW=="boolean"?bV?1:0:bW=="number"?bV:bW=="string"?E.hashString(bV):bW=="object"?bV==null?0:bV instanceof a.Array?E.hashArray(bV):E.hashObject(bV):0;};E.hashString=function(bV){var bW,bX,bY;if(bV===null)return 0;else{bW=5381;for(bX=0,bY=bV.length-1;bX<=bY;bX++)bW=E.hashMix(bW,bV[bX].charCodeAt());return bW;}};E.hashArray=function(bV){var bW,bX,bY;bW=-34948909;for(bX=0,bY=P.length(bV)-1;bX<=bY;bX++)bW=E.hashMix(bW,E.Hash(P.get(bV,bX)));return bW;};E.hashObject=function(bV){var bW,bX;if("GetHashCode"in bV)return bV.GetHashCode();else{bW=[0];for(var bY in bV)if(function(bZ){bW[0]=E.hashMix(E.hashMix(bW[0],E.hashString(bZ)),E.Hash(bV[bZ]));return false;}(bY))break;return bW[0];}};E.hashMix=function(bV,bW){return(bV<<5)+bV+bW;};E.Compare=function(bV,bW){var bX,bY,bZ,b0,b1,b2;if(bV===bW)return 0;else{bY=typeof bV;switch(bY=="function"?1:bY=="boolean"?2:bY=="number"?2:bY=="string"?2:bY=="object"?3:0){case 0:return typeof bW=="undefined"?0:-1;case 1:return o.FailWith("Cannot compare function values.");case 2:return bV<bW?-1:1;case 3:if(bV===null)bZ=-1;else if(bW===null)bZ=1;else if("CompareTo"in bV)bZ=bV.CompareTo(bW);else if("CompareTo0"in bV)bZ=bV.CompareTo0(bW);else if(bV instanceof a.Array&&bW instanceof a.Array)bZ=E.compareArrays(bV,bW);else if(bV instanceof a.Date&&bW instanceof a.Date)bZ=E.compareDates(bV,bW);else{b0=[0];for(var b3 in bV)if(function(b4){return!bV.hasOwnProperty(b4)?false:!bW.hasOwnProperty(b4)?(b0[0]=1,true):(b0[0]=E.Compare(bV[b4],bW[b4]),b0[0]!==0);}(b3))break;if(b0[0]===0){for(var b4 in bW)if(function(b5){return!bW.hasOwnProperty(b5)?false:!bV.hasOwnProperty(b5)&&(b0[0]=-1,true);}(b4))break;}bZ=b0[0];}return bZ;}}};E.compareArrays=function(bV,bW){var bX,bY;if(P.length(bV)<P.length(bW))return -1;else if(P.length(bV)>P.length(bW))return 1;else{bX=0;bY=0;while(bX===0&&bY<P.length(bV)){bX=E.Compare(P.get(bV,bY),P.get(bW,bY));bY=bY+1;}return bX;}};E.compareDates=function(bV,bW){return E.Compare(bV.getTime(),bW.getTime());};F=l.Instance=bR.Class({},x,F);F.New=bR.Ctor(function(bV,bW){x.New.call(this,bV,bW);},F);G.CompleteHoles=function(bV,bW,bX){var bZ,b0,b1,b2,b3;function bY(b4,b5){var b6;return b0.Contains(b4)?null:(b6=E.Equals(b5,0)?X.GetOrAddHoleFor(bV,b4,function(){return{$:8,$0:b4,$1:i.Create$1("")};}):E.Equals(b5,1)?X.GetOrAddHoleFor(bV,b4,function(){return{$:13,$0:b4,$1:i.Create$1(0)};}):E.Equals(b5,2)?X.GetOrAddHoleFor(bV,b4,function(){return{$:9,$0:b4,$1:i.Create$1(false)};}):o.FailWith("Invalid value type"),(bZ.set_Item(b4,b6),{$:1,$0:b6}));}bZ=new N.New$5();b0=new W.New$3();b1=_0.Get(bW);try{while(b1.MoveNext()){b2=b1.Current();b3=b2.$0;b0.SAdd(b3);bZ.set_Item(b3,b2);}}finally{if(typeof b1=="object"&&"Dispose"in b1)b1.Dispose();}return[z.append(bW,P.choose(function(b4){return bY(b4[0],b4[1]);},bX)),{$:0,$0:bZ}];};H.main=function(bV){$.LoadLocalTemplates("index");return bV?$.NamedTemplate("index",{$:1,$0:"main"},bV):void 0;};H.listitem=function(bV){$.LoadLocalTemplates("index");return bV?$.NamedTemplate("index",{$:1,$0:"listitem"},bV):void 0;};K.NewGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(new a.RegExp("[xy]","g"),function(bV){var bW,bX;bW=bT.random()*16|0;bX=bV=="x"?bW:bW&3|8;return bX.toString(16);});};L=g.View=bR.Class({},null,L);N=M.Dictionary=bR.Class({set_Item:function(bV,bW){this.set(bV,bW);},TryGetValue:function(bV,bW){var bX,bY,bZ;bX=this;bY=this.data[this.hash(bV)];return bY==null?false:(bZ=P.tryPick(function(b0){var b1;b1=o.KeyValue(b0);return bX.equals.apply(null,[b1[0],bV])?{$:1,$0:b1[1]}:null;},bY),bZ!=null&&bZ.$==1&&(bW.set(bZ.$0),true));},RemoveKey:function(bV){return this.remove(bV);},set:function(bV,bW){var bX,bY,bZ,b0;bX=this;bY=this.hash(bV);bZ=this.data[bY];if(bZ==null){this.count=this.count+1;this.data[bY]=new a.Array({K:bV,V:bW});}else{b0=P.tryFindIndex(function(b1){return bX.equals.apply(null,[(o.KeyValue(b1))[0],bV]);},bZ);b0==null?(this.count=this.count+1,bZ.push({K:bV,V:bW})):bZ[b0.$0]={K:bV,V:bW};}},remove:function(bV){var bW,bX,bY,bZ;bW=this;bX=this.hash(bV);bY=this.data[bX];return bY==null?false:(bZ=P.filter(function(b0){return!bW.equals.apply(null,[(o.KeyValue(b0))[0],bV]);},bY),P.length(bZ)<bY.length&&(this.count=this.count-1,this.data[bX]=bZ,true));},ContainsKey:function(bV){var bW,bX;bW=this;bX=this.data[this.hash(bV)];return bX==null?false:P.exists(function(bY){return bW.equals.apply(null,[(o.KeyValue(bY))[0],bV]);},bX);},Item:function(bV){return this.get(bV);},Keys:function(){return new bx.New(this);},Values:function(){return new bB.New(this);},get:function(bV){var bW,bX;bW=this;bX=this.data[this.hash(bV)];return bX==null?_9.notPresent():P.pick(function(bY){var bZ;bZ=o.KeyValue(bY);return bW.equals.apply(null,[bZ[0],bV])?{$:1,$0:bZ[1]}:null;},bX);}},c,N);N.New$5=bR.Ctor(function(){N.New$6.call(this,[],E.Equals,E.Hash);},N);N.New$6=bR.Ctor(function(bV,bW,bX){var bY,bZ;c.New.call(this);this.equals=bW;this.hash=bX;this.count=0;this.data=[];bY=_0.Get(bV);try{while(bY.MoveNext()){bZ=bY.Current();this.set(bZ.K,bZ.V);}}finally{if(typeof bY=="object"&&"Dispose"in bY)bY.Dispose();}},N);q.New=function(bV){return{s:bV};};O=m.Instance=bR.Class({},x,O);O.New=bR.Ctor(function(bV,bW){x.New.call(this,bV,bW);},O);P.tryFindIndex=function(bV,bW){var bX,bY;bX=null;bY=0;while(bY<bW.length&&bX==null){bV(bW[bY])?bX={$:1,$0:bY}:void 0;bY=bY+1;}return bX;};P.ofSeq=function(bV){var bW,bX;if(bV instanceof a.Array)return bV.slice();else if(bV instanceof Z)return P.ofList(bV);else{bW=[];bX=_0.Get(bV);try{while(bX.MoveNext())bW.push(bX.Current());return bW;}finally{if(typeof bX=="object"&&"Dispose"in bX)bX.Dispose();}}};P.choose=function(bV,bW){var bX,bY,bZ,b0;bX=[];for(bY=0,bZ=bW.length-1;bY<=bZ;bY++){b0=bV(bW[bY]);if(b0==null);else bX.push(b0.$0);}return bX;};P.ofList=function(bV){var bW,bX;bX=[];bW=bV;while(!(bW.$==0)){bX.push(Y.head(bW));bW=Y.tail(bW);}return bX;};P.tryPick=function(bV,bW){var bX,bY,bZ;bX=null;bY=0;while(bY<bW.length&&bX==null){bZ=bV(bW[bY]);if(bZ!=null&&bZ.$==1)bX=bZ;bY=bY+1;}return bX;};P.foldBack=function(bV,bW,bX){var bY,bZ,b0,b1,b2;bY=bX;b0=bW.length;for(b1=1,b2=b0;b1<=b2;b1++)bY=bV(bW[b0-b1],bY);return bY;};P.filter=function(bV,bW){var bX,bY,bZ;bX=[];for(bY=0,bZ=bW.length-1;bY<=bZ;bY++)if(bV(bW[bY]))bX.push(bW[bY]);return bX;};P.iter=function(bV,bW){var bX,bY;for(bX=0,bY=bW.length-1;bX<=bY;bX++)bV(bW[bX]);};P.map=function(bV,bW){var bX,bY,bZ;bX=new a.Array(bW.length);for(bY=0,bZ=bW.length-1;bY<=bZ;bY++)bX[bY]=bV(bW[bY]);return bX;};P.exists=function(bV,bW){var bX,bY,bZ,b0;bX=false;bY=0;b0=P.length(bW);while(!bX&&bY<b0)if(bV(bW[bY]))bX=true;else bY=bY+1;return bX;};P.pick=function(bV,bW){var bX;bX=P.tryPick(bV,bW);return bX==null?o.FailWith("KeyNotFoundException"):bX.$0;};P.create=function(bV,bW){var bX,bY,bZ;bX=new a.Array(bV);for(bY=0,bZ=bV-1;bY<=bZ;bY++)bX[bY]=bW;return bX;};P.init=function(bV,bW){var bX,bY,bZ;if(bV<0)o.FailWith("Negative size given.");else null;bX=new a.Array(bV);for(bY=0,bZ=bV-1;bY<=bZ;bY++)bX[bY]=bW(bY);return bX;};P.forall=function(bV,bW){var bX,bY,bZ,b0;bX=true;bY=0;b0=P.length(bW);while(bX&&bY<b0)if(bV(bW[bY]))bY=bY+1;else bX=false;return bX;};Q=y.ArrayStorage=bR.Class({SSetAt:function(bV,bW,bX){P.set(bX,bV,bW);return bX;},SAppend:function(bV,bW){bW.push(bV);return bW;},SInit:function(){return this.init;}},c,Q);Q.New=bR.Ctor(function(bV){c.New.call(this);this.init=bV;},Q);R.TryParseInt32=function(bV,bW){return R.TryParse(bV,-2147483648,2147483647,bW);};T.LinkElement=function(bV,bW){T.InsertDoc(bV,bW,null);};T.InsertDoc=function(bV,bW,bX){var bY,bZ,b0;while(true)if(bW!=null&&bW.$==1)return T.InsertNode(bV,bW.$0.El,bX);else if(bW!=null&&bW.$==2){bY=bW.$0;bY.Dirty=false;bW=bY.Current;}else if(bW==null)return bX;else if(bW!=null&&bW.$==4)return T.InsertNode(bV,bW.$0.Text,bX);else if(bW!=null&&bW.$==5)return T.InsertNode(bV,bW.$0,bX);else if(bW!=null&&bW.$==6)return P.foldBack(function(b1,b2){return(((bR.Curried3(function(b3,b4,b5){return b4==null||b4.constructor===I?T.InsertDoc(b3,b4,b5):T.InsertNode(b3,b4,b5);}))(bV))(b1))(b2);},bW.$0.Els,bX);else{bZ=bW.$1;b0=bW.$0;bW=b0;bX=T.InsertDoc(bV,bZ,bX);}};T.CreateRunState=function(bV,bW){return bd.New(be.get_Empty(),T.CreateElemNode(bV,bj.EmptyAttr(),bW));};T.PerformAnimatedUpdate=function(bV,bW,bX){var bY;return _5.get_UseAnimations()?(bY=null,bf.Delay(function(){var bZ,b0,b1;bZ=be.FindAll(bX);b0=T.ComputeChangeAnim(bW,bZ);b1=T.ComputeEnterAnim(bW,bZ);return bf.Bind(_5.Play(_5.Append(b0,T.ComputeExitAnim(bW,bZ))),function(){return bf.Bind(T.SyncElemNodesNextFrame(bV,bW),function(){return bf.Bind(_5.Play(b1),function(){bW.PreviousNodes=bZ;return bf.Return(null);});});});})):T.SyncElemNodesNextFrame(bV,bW);};T.PerformSyncUpdate=function(bV,bW,bX){var bY;bY=be.FindAll(bX);T.SyncElemNode(bV,bW.Top);bW.PreviousNodes=bY;};T.InsertNode=function(bV,bW,bX){_4.InsertAt(bV,bX,bW);return bW;};T.CreateElemNode=function(bV,bW,bX){var bY;T.LinkElement(bV,bX);bY=bj.Insert(bV,bW);return _2.New(bY,bX,null,bV,B.Int(),bR.GetOptional(bY.OnAfterRender));};T.SyncElemNodesNextFrame=function(bV,bW){function bX(bY){a.requestAnimationFrame(function(){T.SyncElemNode(bV,bW.Top);bY();});}return _7.BatchUpdatesEnabled()?bf.FromContinuations(function(bY,bZ,b0){return bX.apply(null,[bY,bZ,b0]);}):(T.SyncElemNode(bV,bW.Top),bf.Return(null));};T.ComputeExitAnim=function(bV,bW){return _5.Concat(P.map(function(bX){return bj.GetExitAnim(bX.Attr);},be.ToArray(be.Except(bW,be.Filter(function(bX){return bj.HasExitAnim(bX.Attr);},bV.PreviousNodes)))));};T.ComputeEnterAnim=function(bV,bW){return _5.Concat(P.map(function(bX){return bj.GetEnterAnim(bX.Attr);},be.ToArray(be.Except(bV.PreviousNodes,be.Filter(function(bX){return bj.HasEnterAnim(bX.Attr);},bW)))));};T.ComputeChangeAnim=function(bV,bW){var bX;function bY(bZ){return bj.HasChangeAnim(bZ.Attr);}bX=function(bZ){return be.Filter(bY,bZ);};return _5.Concat(P.map(function(bZ){return bj.GetChangeAnim(bZ.Attr);},be.ToArray(be.Intersect(bX(bV.PreviousNodes),bX(bW)))));};T.SyncElemNode=function(bV,bW){!bV?T.SyncElement(bW):void 0;T.Sync(bW.Children);T.AfterRender(bW);};T.CreateEmbedNode=function(){return{Current:null,Dirty:false};};T.UpdateEmbedNode=function(bV,bW){bV.Current=bW;bV.Dirty=true;};T.SyncElement=function(bV){function bW(bX){function bY(bZ){var b0,b1,b2,b3;while(true){if(bZ!=null&&bZ.$==0){b1=bZ.$1;b2=bZ.$0;if(bY(b2))return true;else bZ=b1;}else if(bZ!=null&&bZ.$==2){b3=bZ.$0;if(b3.Dirty)return true;else bZ=b3.Current;}else return bZ!=null&&bZ.$==6&&(b0=bZ.$0,b0.Dirty||P.exists(bW,b0.Holes));}}return bY(bX.Children);}bj.Sync(bV.El,bV.Attr);if(bW(bV))T.DoSyncElement(bV);};T.Sync=function(bV){var bW,bX,bY,bZ,b0;while(true){if(bV!=null&&bV.$==1)return T.SyncElemNode(false,bV.$0);else if(bV!=null&&bV.$==2){bY=bV.$0;bV=bY.Current;}else if(bV==null)return null;else if(bV!=null&&bV.$==5)return null;else if(bV!=null&&bV.$==4){bW=bV.$0;return bW.Dirty?(bW.Text.nodeValue=bW.Value,bW.Dirty=false):null;}else if(bV!=null&&bV.$==6){bX=bV.$0;P.iter(function(b1){T.SyncElemNode(false,b1);},bX.Holes);P.iter(function(b1){bj.Sync(b1[0],b1[1]);},bX.Attrs);return T.AfterRender(bX);}else{bZ=bV.$1;b0=bV.$0;T.Sync(b0);bV=bZ;}}};T.AfterRender=function(bV){var bW;bW=bR.GetOptional(bV.Render);if(bW!=null&&bW.$==1){bW.$0(bV.El);bR.SetOptional(bV,"Render",null);}};T.DoSyncElement=function(bV){var bW,bX,bY;function bZ(b0,b1){var b2,b3,b4,b5;while(true){if(b0!=null&&b0.$==1)return b0.$0.El;else if(b0!=null&&b0.$==2){b3=b0.$0;if(b3.Dirty){b3.Dirty=false;return T.InsertDoc(bW,b3.Current,b1);}else b0=b3.Current;}else if(b0==null)return b1;else if(b0!=null&&b0.$==4)return b0.$0.Text;else if(b0!=null&&b0.$==5)return b0.$0;else if(b0!=null&&b0.$==6){b2=b0.$0;b2.Dirty?b2.Dirty=false:void 0;return P.foldBack(function(b6,b7){return b6==null||b6.constructor===I?bZ(b6,b7):b6;},b2.Els,b1);}else{b4=b0.$1;b5=b0.$0;b0=b5;b1=bZ(b4,b1);}}}bW=bV.El;bF.Iter((bX=bV.El,function(b0){_4.RemoveNode(bX,b0);}),bF.Except(bF.DocChildren(bV),bF.Children(bV.El,bR.GetOptional(bV.Delimiters))));bZ(bV.Children,(bY=bR.GetOptional(bV.Delimiters),bY!=null&&bY.$==1?bY.$0[1]:null));};T.InsertBeforeDelim=function(bV,bW){var bX,bY;bX=bV.parentNode;bY=self.document.createTextNode("");bX.insertBefore(bY,bV);T.LinkPrevElement(bV,bW);return bY;};T.CreateTextNode=function(){return{Text:self.document.createTextNode(""),Dirty:false,Value:""};};T.UpdateTextNode=function(bV,bW){bV.Value=bW;bV.Dirty=true;};T.LinkPrevElement=function(bV,bW){T.InsertDoc(bV.parentNode,bW,bV);};U=g.AttrProxy=bR.Class({},null,U);U.Handler=function(bV,bW){return U.HandlerImpl(bV,bW);};U.Concat=function(bV){var bW;bW=bi.ofSeqNonCopying(bV);return bi.TreeReduce(bj.EmptyAttr(),U.Append,bW);};U.Create=function(bV,bW){return bj.Static(function(bX){bX.setAttribute(bV,bW);});};U.HandlerImpl=function(bV,bW){return bj.Static(function(bX){bX.addEventListener(bV,function(bY){return(bW(bX))(bY);},false);});};U.Append=function(bV,bW){return bj.AppendTree(bV,bW);};V=g.CheckedInput=bR.Class({get_Input:function(){return this.$==1?this.$0:this.$==2?this.$0:this.$1;}},null,V);W=M.HashSet=bR.Class({SAdd:function(bV){return this.add(bV);},Contains:function(bV){var bW;bW=this.data[this.hash(bV)];return bW==null?false:this.arrContains(bV,bW);},add:function(bV){var bW,bX;bW=this.hash(bV);bX=this.data[bW];return bX==null?(this.data[bW]=[bV],this.count=this.count+1,true):this.arrContains(bV,bX)?false:(bX.push(bV),this.count=this.count+1,true);},arrContains:function(bV,bW){var bX,bY,bZ,b0;bX=true;bY=0;b0=bW.length;while(bX&&bY<b0)if(this.equals.apply(null,[bW[bY],bV]))bX=false;else bY=bY+1;return!bX;},ExceptWith:function(bV){var bW;bW=_0.Get(bV);try{while(bW.MoveNext())this.Remove(bW.Current());}finally{if(typeof bW=="object"&&"Dispose"in bW)bW.Dispose();}},Count:function(){return this.count;},CopyTo:function(bV){var bW,bX,bY,bZ;bW=0;bX=bK.concat(this.data);for(bY=0,bZ=bX.length-1;bY<=bZ;bY++)P.set(bV,bY,bX[bY]);},IntersectWith:function(bV){var bW,bX,bY,bZ,b0;bW=new W.New$4(bV,this.equals,this.hash);bX=bK.concat(this.data);for(bY=0,bZ=bX.length-1;bY<=bZ;bY++){b0=bX[bY];if(!bW.Contains(b0))this.Remove(b0);}},Remove:function(bV){var bW;bW=this.data[this.hash(bV)];return bW==null?false:this.arrRemove(bV,bW)&&(this.count=this.count-1,true);},arrRemove:function(bV,bW){var bX,bY,bZ,b0;bX=true;bY=0;b0=bW.length;while(bX&&bY<b0)if(this.equals.apply(null,[bW[bY],bV])){bW.splice.apply(bW,[bY,1]);bX=false;}else bY=bY+1;return!bX;}},c,W);W.New$3=bR.Ctor(function(){W.New$4.call(this,[],E.Equals,E.Hash);},W);W.New$4=bR.Ctor(function(bV,bW,bX){var bY;c.New.call(this);this.equals=bW;this.hash=bX;this.data=[];this.count=0;bY=_0.Get(bV);try{while(bY.MoveNext())this.add(bY.Current());}finally{if(typeof bY=="object"&&"Dispose"in bY)bY.Dispose();}},W);W.New$2=bR.Ctor(function(bV){W.New$4.call(this,bV,E.Equals,E.Hash);},W);P.get=function(bV,bW){P.checkBounds(bV,bW);return bV[bW];};P.length=function(bV){return bV.dims===2?bV.length*bV.length:bV.length;};P.checkBounds=function(bV,bW){if(bW<0||bW>=bV.length)o.FailWith("Index was outside the bounds of the array.");};P.set=function(bV,bW,bX){P.checkBounds(bV,bW);bV[bW]=bX;};X.$cctor=function(){X.$cctor=a.ignore;X.initialized=new N.New$5();};X=w.TemplateInitializer=bR.Class({},c,X);X.GetOrAddHoleFor=function(bV,bW,bX){var bY,bZ,b0,b1;X.$cctor();bY=X.GetHolesFor(bV);bZ=(b0=null,[bY.TryGetValue(bW,{get:function(){return b0;},set:function(b2){b0=b2;}}),b0]);return bZ[0]?bZ[1]:(b1=bX(),(bY.set_Item(bW,b1),b1));};X.GetHolesFor=function(bV){var bW,bX,bY;X.$cctor();bW=(bX=null,[X.initialized.TryGetValue(bV,{get:function(){return bX;},set:function(bZ){bX=bZ;}}),bX]);return bW[0]?bW[1]:(bY=new N.New$5(),(X.initialized.set_Item(bV,bY),bY));};L.MapSeqCached=function(bV,bW){return L.MapSeqCachedBy(a.id,bV,bW);};L.Sink=function(bV,bW){function bX(){q.WhenRun(bW(),bV,function(){bf.scheduler().Fork(bX);});}bf.scheduler().Fork(bX);};L.MapSeqCachedBy=function(bV,bW,bX){var bY;bY=[new N.New$5()];return L.Map(function(bZ){var b0,b1,b2;b0=bY[0];b1=new N.New$5();b2=bi.mapInPlace(function(b3){var b4,b5;b4=bV(b3);b5=b0.ContainsKey(b4)?b0.Item(b4):bW(b3);b1.set_Item(b4,b5);return b5;},P.ofSeq(bZ));bY[0]=b1;return b2;},bX);};L.Map=function(bV,bW){return L.CreateLazy(function(){return q.Map(bV,bW());});};L.CreateLazy=function(bV){var bW;bW={c:null,o:bV};return function(){var bX,bY;bX=bW.c;return bX===null?(bX=bW.o(),bW.c=bX,(bY=bX.s,bY!=null&&bY.$==0)?bW.o=null:q.WhenObsoleteRun(bX,function(){bW.c=null;}),bX):bX;};};L.Bind=function(bV,bW){return L.Join(L.Map(bV,bW));};L.Const=function(bV){var bW;bW=q.New({$:0,$0:bV});return function(){return bW;};};L.Map2Unit=function(bV,bW){return L.CreateLazy(function(){return q.Map2Unit(bV(),bW());});};L.Join=function(bV){return L.CreateLazy(function(){return q.Join(bV());});};L.Map3=function(bV,bW,bX,bY){return L.CreateLazy(function(){return q.Map3(bV,bW(),bX(),bY());});};L.Sequence=function(bV){return L.CreateLazy(function(){return q.Sequence(z.map(function(bW){return bW();},bV));});};L.Map2=function(bV,bW,bX){return L.CreateLazy(function(){return q.Map2(bV,bW(),bX());});};Z=Y.T=bR.Class({GetEnumerator:function(){return new _.New(this,null,function(bV){var bW;bW=bV.s;return bW.$==0?false:(bV.c=bW.$0,bV.s=bW.$1,true);},void 0);}},null,Z);Z.Empty=new Z({$:0});_0.Get=function(bV){return bV instanceof a.Array?_0.ArrayEnumerator(bV):E.Equals(typeof bV,"string")?_0.StringEnumerator(bV):bV.GetEnumerator();};_0.ArrayEnumerator=function(bV){return new _.New(0,null,function(bW){var bX;bX=bW.s;return bX<P.length(bV)&&(bW.c=P.get(bV,bX),bW.s=bX+1,true);},void 0);};_0.StringEnumerator=function(bV){return new _.New(0,null,function(bW){var bX;bX=bW.s;return bX<bV.length&&(bW.c=bV[bX],bW.s=bX+1,true);},void 0);};_1.$cctor=function(){_1.$cctor=a.ignore;_1.counter=0;};_2=g.DocElemNode=bR.Class({Equals:function(bV){return this.ElKey===bV.ElKey;},GetHashCode:function(){return this.ElKey;}},null,_2);_2.New=function(bV,bW,bX,bY,bZ,b0){var b1;return new _2((b1={Attr:bV,Children:bW,El:bY,ElKey:bZ},(bR.SetOptional(b1,"Delimiters",bX),bR.SetOptional(b1,"Render",b0),b1)));};_4.InsertAt=function(bV,bW,bX){var bY;if(!(bX.parentNode===bV&&bW===(bY=bX.nextSibling,E.Equals(bY,null)?null:bY)))bV.insertBefore(bX,bW);};_4.ParseHTMLIntoFakeRoot=function(bV){var bW,bX,bY,bZ,b0;function b1(b2,b3){var b4;while(true)if(b3===0)return b2;else{b4=b3;b2=b2.lastChild;b3=b4-1;}}bW=self.document.createElement("div");return!_4.rhtml().test(bV)?(bW.appendChild(self.document.createTextNode(bV)),bW):(bX=(bY=_4.rtagName().exec(bV),E.Equals(bY,null)?"":P.get(bY,1).toLowerCase()),(bZ=(b0=(_4.wrapMap())[bX],b0?b0:_4.defaultWrap()),(bW.innerHTML=bZ[1]+bV.replace(_4.rxhtmlTag(),"<$1></$2>")+bZ[2],b1(bW,bZ[0]))));};_4.ChildrenArray=function(bV){var bW,bX,bY;bW=[];for(bX=0,bY=bV.childNodes.length-1;bX<=bY;bX++)bW.push(bV.childNodes[bX]);return bW;};_4.RemoveNode=function(bV,bW){if(bW.parentNode===bV)bV.removeChild(bW);};_4.rhtml=function(){bM.$cctor();return bM.rhtml;};_4.wrapMap=function(){bM.$cctor();return bM.wrapMap;};_4.defaultWrap=function(){bM.$cctor();return bM.defaultWrap;};_4.rxhtmlTag=function(){bM.$cctor();return bM.rxhtmlTag;};_4.rtagName=function(){bM.$cctor();return bM.rtagName;};_4.IterSelector=function(bV,bW,bX){var bY,bZ,b0;bY=bV.querySelectorAll(bW);for(bZ=0,b0=bY.length-1;bZ<=b0;bZ++)bX(bY[bZ]);};_5.get_UseAnimations=function(){return bg.UseAnimations();};_5.Play=function(bV){var bW;bW=null;return bf.Delay(function(){return bf.Bind(_5.Run(a.ignore,bg.Actions(bV)),function(){bg.Finalize(bV);return bf.Return(null);});});};_5.Append=function(bV,bW){return{$:0,$0:bl.Append(bV.$0,bW.$0)};};_5.Run=function(bV,bW){var bX;function bY(bZ){function b0(b1){return function(b2){var b3;b3=b2-b1;bW.Compute(b3);bV();return b3<=bX?void a.requestAnimationFrame(function(b4){(b0(b1))(b4);}):bZ();};}a.requestAnimationFrame(function(b1){(b0(b1))(b1);});}bX=bW.Duration;return bX===0?bf.Zero():bf.FromContinuations(function(bZ,b0,b1){return bY.apply(null,[bZ,b0,b1]);});};_5.Concat=function(bV){return{$:0,$0:bl.Concat(z.map(bg.List,bV))};};_5.get_Empty=function(){return{$:0,$0:bl.Empty()};};_7.BatchUpdatesEnabled=function(){bh.$cctor();return bh.BatchUpdatesEnabled;};_8.StartProcessor=function(bV){var bW;function bX(){var bY;bY=null;return bf.Delay(function(){return bf.Bind(bV,function(){var bZ;bZ=bW[0];return E.Equals(bZ,1)?(bW[0]=0,bf.Zero()):E.Equals(bZ,2)?(bW[0]=1,bX()):bf.Zero();});});}bW=[0];return function(){var bY;bY=bW[0];if(E.Equals(bY,0)){bW[0]=1;bf.Start(bX(),null);}else E.Equals(bY,1)?bW[0]=2:void 0;};};_9.notPresent=function(){return o.FailWith("The given key was not present in the dictionary.");};_=_0.T=bR.Class({MoveNext:function(){var bV;bV=this.n(this);this.e=bV?1:2;return bV;},Current:function(){return this.e===1?this.c:this.e===0?o.FailWith("Enumeration has not started. Call MoveNext."):o.FailWith("Enumeration already finished.");},Dispose:function(){if(this.d)this.d(this);}},c,_);_.New=bR.Ctor(function(bV,bW,bX,bY){c.New.call(this);this.s=bV;this.c=bW;this.n=bX;this.d=bY;this.e=0;},_);$.LoadLocalTemplates=function(bV){!$.LocalTemplatesLoaded()?($.set_LocalTemplatesLoaded(true),$.LoadNestedTemplates(self.document.body,"")):void 0;$.LoadedTemplates().set_Item(bV,$.LoadedTemplateFile(""));};$.NamedTemplate=function(bV,bW,bX){var bY,bZ;bY=(bZ=null,[$.LoadedTemplateFile(bV).TryGetValue(bW==null?"":bW.$0,{get:function(){return bZ;},set:function(b0){bZ=b0;}}),bZ]);return bY[0]?$.ChildrenTemplate(bY[1].cloneNode(true),bX):(bS.warn("Local template doesn't exist",bW),r.get_Empty());};$.LocalTemplatesLoaded=function(){bm.$cctor();return bm.LocalTemplatesLoaded;};$.set_LocalTemplatesLoaded=function(bV){bm.$cctor();bm.LocalTemplatesLoaded=bV;};$.LoadNestedTemplates=function(bV,bW){var bY,bZ,b0,b1,b2,b3,b4,b5,b6,b7,b8,b9,b_;function bX(b$){var ca,cb;if(!bY.ContainsKey(b$)){ca=(cb=null,[bZ.TryGetValue(b$,{get:function(){return cb;},set:function(cc){cb=cc;}}),cb]);if(ca[0]){b_.SAdd(b$);bZ.RemoveKey(b$);$.PrepareTemplateStrict(bW,{$:1,$0:b$},ca[1],{$:1,$0:bX});}else bS.warn(b_.Contains(b$)?"Encountered loop when instantiating "+b$:"Local template does not exist: "+b$);}}bY=$.LoadedTemplateFile(bW);bZ=new N.New$5();b0=bV.querySelectorAll("[ws-template]");for(b1=0,b2=b0.length-1;b1<=b2;b1++){b3=b0[b1];b4=b3.getAttribute("ws-template").toLowerCase();b3.removeAttribute("ws-template");bZ.set_Item(b4,$.FakeRootSingle(b3));}b5=bV.querySelectorAll("[ws-children-template]");for(b6=0,b7=b5.length-1;b6<=b7;b6++){b8=b5[b6];b9=b8.getAttribute("ws-children-template").toLowerCase();b8.removeAttribute("ws-children-template");bZ.set_Item(b9,$.FakeRoot(b8));}b_=new W.New$3();while(bZ.count>0)bX(z.head(bZ.Keys()));};$.LoadedTemplates=function(){bm.$cctor();return bm.LoadedTemplates;};$.LoadedTemplateFile=function(bV){var bW,bX,bY;bW=(bX=null,[$.LoadedTemplates().TryGetValue(bV,{get:function(){return bX;},set:function(bZ){bX=bZ;}}),bX]);return bW[0]?bW[1]:(bY=new N.New$5(),($.LoadedTemplates().set_Item(bV,bY),bY));};$.ChildrenTemplate=function(bV,bW){var bX,bY,bZ,b0,b1;bX=$.InlineTemplate(bV,z.append(bW,$.GlobalHoles().Values()));bY=bX[1];bZ=bX[0];b0=bZ.Els;return!E.Equals(b0,null)&&b0.length===1&&(P.get(b0,0)instanceof D&&(E.Equals(P.get(b0,0).nodeType,D.ELEMENT_NODE)&&(b1=P.get(b0,0),true)))?bn.TreeNode(bZ,bY):r.Mk({$:6,$0:bZ},bY);};$.FakeRootSingle=function(bV){var bW,bX,bY,bZ;bV.removeAttribute("ws-template");bW=bV.getAttribute("ws-replace");if(bW===null);else{bV.removeAttribute("ws-replace");bX=bV.parentNode;E.Equals(bX,null)?void 0:(bY=self.document.createElement(bV.tagName),bY.setAttribute("ws-replace",bW),bX.replaceChild(bY,bV));}bZ=self.document.createElement("div");bZ.appendChild(bV);return bZ;};$.FakeRoot=function(bV){var bW;bW=self.document.createElement("div");while(bV.hasChildNodes())bW.appendChild(bV.firstChild);return bW;};$.PrepareTemplateStrict=function(bV,bW,bX,bY){var bZ;function b0(b6,b7){var b8,b9,b_,b$,ca,cc,cd,ce,cf,cg,ch,ci,cj,ck,cl,cm,cn,co,cp,cq,cr,cs,ct,cu,cv,cw;function cb(cx){}while(true)switch(b6){case 0:if(b7!==null){b8=b7.nextSibling;if(E.Equals(b7.nodeType,D.TEXT_NODE))bv.convertTextNode(b7);else if(E.Equals(b7.nodeType,D.ELEMENT_NODE))b2(b7);b7=b8;}else return null;break;case 1:cc=bw.string(b7.nodeName,{$:1,$0:3},null).toLowerCase();cd=(b9=cc.indexOf("."),b9===-1?[bV,cc]:[bw.string(cc,null,{$:1,$0:b9-1}),bw.string(cc,{$:1,$0:b9+1},null)]);ce=cd[1];cf=cd[0];if(cf!==""&&!$.LoadedTemplates().ContainsKey(cf))return bv.failNotLoaded(ce);else{if(cf===""&&bY!=null)bY.$0(ce);cg=$.LoadedTemplates().Item(cf);if(!cg.ContainsKey(ce))return bv.failNotLoaded(ce);else{ch=cg.Item(ce);ci=ch.cloneNode(true);cj=new W.New$3();ck=new N.New$5();cl=b7.attributes;for(cm=0,cn=cl.length-1;cm<=cn;cm++){co=cl.item(cm).name.toLowerCase();ck.set_Item(co,(cp=cl.item(cm).nodeValue,cp===""?co:cp.toLowerCase()));if(!cj.SAdd(co))bS.warn("Hole mapped twice",co);}for(cq=0,cr=b7.childNodes.length-1;cq<=cr;cq++){cs=b7.childNodes[cq];if(E.Equals(cs.nodeType,D.ELEMENT_NODE))!cj.SAdd(cs.nodeName.toLowerCase())?bS.warn("Hole filled twice",ce):void 0;}ct=b7.childNodes.length===1&&E.Equals(b7.firstChild.nodeType,D.TEXT_NODE);if(ct){b$=bv.fillTextHole(ci,b7.firstChild.textContent,ce);((function(cx){return function(cy){if(cy!=null)cx(cy.$0);};}((ca=function(cx){return function(cy){return cx.SAdd(cy);};}(cj),function(cx){return cb(ca(cx));})))(b$));}bv.removeHolesExcept(ci,cj);if(!ct){for(cu=0,cv=b7.childNodes.length-1;cu<=cv;cu++){cw=b7.childNodes[cu];if(E.Equals(cw.nodeType,D.ELEMENT_NODE))cw.hasAttributes()?bv.fillInstanceAttrs(ci,cw):b1(ci,cw);}}bv.mapHoles(ci,ck);bv.fill(ci,b7.parentNode,b7);b7.parentNode.removeChild(b7);return;}}break;}}function b1(b6,b7){var b8,b_,b$;function b9(ca,cb){var cc;if(b_==="title"&&b7.hasChildNodes()){cc=_4.ParseHTMLIntoFakeRoot(b7.textContent);b7.removeChild(b7.firstChild);while(cc.hasChildNodes())b7.appendChild(cc.firstChild);}else null;b2(b7);return bv.fill(b7,ca,cb);}b_=b7.nodeName.toLowerCase();$.foreachNotPreserved(b6,"[ws-attr-holes]",function(ca){var cb,cc,cd,ce,cf;cb=bz.SplitChars(ca.getAttribute("ws-attr-holes"),[" "],1);for(cc=0,cd=cb.length-1;cc<=cd;cc++){ce=P.get(cb,cc);ca.setAttribute(ce,(cf=new a.RegExp("\\${"+b_+"}","ig"),ca.getAttribute(ce).replace(cf,b7.textContent)));}});b$=b6.querySelector("[ws-hole="+b_+"]");if(E.Equals(b$,null)){b8=b6.querySelector("[ws-replace="+b_+"]");return E.Equals(b8,null)?null:(b9(b8.parentNode,b8),void b8.parentNode.removeChild(b8));}else{while(b$.hasChildNodes())b$.removeChild(b$.lastChild);b$.removeAttribute("ws-hole");return b9(b$,null);}}function b2(b6){if(!b6.hasAttribute("ws-preserve"))if(bz.StartsWith(b6.nodeName.toLowerCase(),"ws-"))b4(b6);else{bv.convertAttrs(b6);b3(b6.firstChild);}}function b3(b6){return b0(0,b6);}function b4(b6){return b0(1,b6);}function b5(b6){var b7,b8,b9,b_;while(true){b7=b6.querySelector("[ws-template]");if(E.Equals(b7,null)){b8=b6.querySelector("[ws-children-template]");if(E.Equals(b8,null))return null;else{b9=b8.getAttribute("ws-children-template");b8.removeAttribute("ws-children-template");$.PrepareTemplateStrict(bV,{$:1,$0:b9},b8,null);b6=b6;}}else{b_=b7.getAttribute("ws-template");($.PrepareSingleTemplate(bV,{$:1,$0:b_},b7))(null);b6=b6;}}}bZ=(bW==null?"":bW.$0).toLowerCase();$.LoadedTemplateFile(bV).set_Item(bZ,bX);if(bX.hasChildNodes()){b5(bX);b3(bX.firstChild);}};$.InlineTemplate=function(bV,bW){var bX,bY,bZ,b0,b3,b4,b5,b6,b7,b8,b9;function b1(b_,b$){var ca,cb,cc;ca=bj.Insert(b_,b$);b4.push(bj.Updates(ca));b5.push([b_,ca]);cb=bR.GetOptional(ca.OnAfterRender);return cb==null?null:(cc=cb.$0,void b6.push(function(){cc(b_);}));}function b2(b_){var b$,ca;b$=(ca=null,[b7.TryGetValue(b_,{get:function(){return ca;},set:function(cb){ca=cb;}}),ca]);return b$[0]?b$[1].$==0?{$:1,$0:b$[1].$1}:b$[1].$==1?{$:1,$0:r.TextNode(b$[1].$1)}:b$[1].$==2?{$:1,$0:r.TextView(b$[1].$1)}:b$[1].$==8?{$:1,$0:r.TextView(b$[1].$1.get_View())}:b$[1].$==9?{$:1,$0:r.TextView(L.Map(a.String,b$[1].$1.get_View()))}:b$[1].$==10?{$:1,$0:r.TextView(L.Map(function(cb){return cb.get_Input();},b$[1].$1.get_View()))}:b$[1].$==11?{$:1,$0:r.TextView(L.Map(a.String,b$[1].$1.get_View()))}:b$[1].$==12?{$:1,$0:r.TextView(L.Map(function(cb){return cb.get_Input();},b$[1].$1.get_View()))}:b$[1].$==13?{$:1,$0:r.TextView(L.Map(a.String,b$[1].$1.get_View()))}:(bS.warn("Content hole filled with attribute data",b_),null):null;}b3=[];b4=[];b5=[];b6=[];b7=new N.New$5();b8=_0.Get(bW);try{while(b8.MoveNext()){b9=b8.Current();b7.set_Item(b9.$0,b9);}}finally{if(typeof b8=="object"&&"Dispose"in b8)b8.Dispose();}bX=_4.ChildrenArray(bV);$.foreachNotPreserved(bV,"[ws-hole]",function(b_){var b$,ca,cb;cb=b_.getAttribute("ws-hole");b_.removeAttribute("ws-hole");while(b_.hasChildNodes())b_.removeChild(b_.lastChild);b$=b2(cb);if(b$!=null&&b$.$==1){ca=b$.$0;T.LinkElement(b_,ca.docNode);b3.push(_2.New(bj.Empty(b_),ca.docNode,null,b_,B.Int(),null));b4.push(ca.updates);}});$.foreachNotPreserved(bV,"[ws-replace]",function(b_){var b$,ca,cb,cc,cd,ce;b$=b2(b_.getAttribute("ws-replace"));if(b$!=null&&b$.$==1){ca=b$.$0;cb=b_.parentNode;cc=self.document.createTextNode("");cb.replaceChild(cc,b_);cd=T.InsertBeforeDelim(cc,ca.docNode);ce=P.tryFindIndex(function(cf){return b_===cf;},bX);ce==null?void 0:P.set(bX,ce.$0,ca.docNode);b3.push(_2.New(bj.Empty(cb),ca.docNode,{$:1,$0:[cd,cc]},cb,B.Int(),null));b4.push(ca.updates);}});$.foreachNotPreserved(bV,"[ws-attr]",function(b_){var b$,ca,cb;b$=b_.getAttribute("ws-attr");b_.removeAttribute("ws-attr");ca=(cb=null,[b7.TryGetValue(b$,{get:function(){return cb;},set:function(cc){cb=cc;}}),cb]);if(ca[0])ca[1].$==3?b1(b_,ca[1].$1):bS.warn("Attribute hole filled with non-attribute data",b$);});$.foreachNotPreserved(bV,"[ws-on]",function(b_){b1(b_,U.Concat(P.choose(function(b$){var ca,cb,cc;ca=bz.SplitChars(b$,[":"],1);cb=(cc=null,[b7.TryGetValue(P.get(ca,1),{get:function(){return cc;},set:function(cd){cc=cd;}}),cc]);return cb[0]?cb[1].$==4?{$:1,$0:by.Handler(P.get(ca,0),cb[1].$1)}:cb[1].$==5?{$:1,$0:U.Handler(P.get(ca,0),cb[1].$1)}:(bS.warn("Event hole on"+P.get(ca,0)+" filled with non-event data",P.get(ca,1)),null):null;},bz.SplitChars(b_.getAttribute("ws-on"),[" "],1))));b_.removeAttribute("ws-on");});$.foreachNotPreserved(bV,"[ws-onafterrender]",function(b_){var b$,ca,cb;b$=b_.getAttribute("ws-onafterrender");ca=(cb=null,[b7.TryGetValue(b$,{get:function(){return cb;},set:function(cc){cb=cc;}}),cb]);if(ca[0])ca[1].$==6?(b_.removeAttribute("ws-onafterrender"),b1(b_,by.OnAfterRender(ca[1].$1))):ca[1].$==7?(b_.removeAttribute("ws-onafterrender"),b1(b_,by.OnAfterRender(ca[1].$1))):bS.warn("onafterrender hole filled with non-onafterrender data",b$);});$.foreachNotPreserved(bV,"[ws-var]",function(b_){var b$,ca,cb;b$=b_.getAttribute("ws-var");b_.removeAttribute("ws-var");ca=(cb=null,[b7.TryGetValue(b$,{get:function(){return cb;},set:function(cc){cb=cc;}}),cb]);if(ca[0])ca[1].$==8?b1(b_,by.Value(ca[1].$1)):ca[1].$==9?b1(b_,by.Checked(ca[1].$1)):ca[1].$==10?b1(b_,by.IntValue(ca[1].$1)):ca[1].$==11?b1(b_,by.IntValueUnchecked(ca[1].$1)):ca[1].$==12?b1(b_,by.FloatValue(ca[1].$1)):ca[1].$==13?b1(b_,by.FloatValueUnchecked(ca[1].$1)):bS.warn("Var hole filled with non-Var data",b$);});$.foreachNotPreserved(bV,"[ws-attr-holes]",function(b_){var b$,ca,cb,cc;b$=new a.RegExp($.TextHoleRE(),"g");ca=bz.SplitChars(b_.getAttribute("ws-attr-holes"),[" "],1);b_.removeAttribute("ws-attr-holes");for(cb=0,cc=ca.length-1;cb<=cc;cb++)(function(){var cd,ce,cf,cg,ch,ci,cj,ck,cl,cm,cn,co,cp;cm=P.get(ca,cb);cn=b_.getAttribute(cm);cd=null;ce=0;co=[];while(cd=b$.exec(cn),cd!==null){cp=bw.string(cn,{$:1,$0:ce},{$:1,$0:b$.lastIndex-P.get(cd,0).length-1});ce=b$.lastIndex;co.push([cp,P.get(cd,1)]);}cg=bw.string(cn,{$:1,$0:ce},null);b$.lastIndex=0;ch=P.foldBack(function(cq,cr){return(function(cs){var ct,cu;ct=cs[0];cu=cs[1];return function(cv){var cw,cx,cy,cz,cA;cw=cv[0];cx=cv[1];cy=(cz=(cA=null,[b7.TryGetValue(cu,{get:function(){return cA;},set:function(cB){cA=cB;}}),cA]),cz[0]?cz[1].$==1?{$:0,$0:cz[1].$1}:cz[1].$==2?{$:1,$0:cz[1].$1}:cz[1].$==8?{$:1,$0:cz[1].$1.get_View()}:cz[1].$==9?{$:1,$0:L.Map(a.String,cz[1].$1.get_View())}:cz[1].$==10?{$:1,$0:L.Map(function(cB){return cB.get_Input();},cz[1].$1.get_View())}:cz[1].$==11?{$:1,$0:L.Map(a.String,cz[1].$1.get_View())}:cz[1].$==12?{$:1,$0:L.Map(function(cB){return cB.get_Input();},cz[1].$1.get_View())}:cz[1].$==13?{$:1,$0:L.Map(a.String,cz[1].$1.get_View())}:(bS.warn("Attribute value hole filled with non-text data",cu),{$:0,$0:""}):{$:0,$0:""});return cy.$==1?[ct,new Z({$:1,$0:cw===""?cy.$0:L.Map(function(cB){return cB+cw;},cy.$0),$1:cx})]:[ct+cy.$0+cw,cx];};}(cq))(cr);},co,[cg,Z.Empty]);return b1(b_,ch[1].$==1?ch[1].$1.$==1?ch[1].$1.$1.$==1?ch[1].$1.$1.$1.$==0?(ci=ch[0],by.Dynamic(cm,L.Map3(function(cq,cr,cs){return ci+cq+cr+cs;},ch[1].$0,ch[1].$1.$0,ch[1].$1.$1.$0))):(cj=ch[0],by.Dynamic(cm,L.Map(function(cq){return cj+bz.concat("",cq);},L.Sequence(ch[1])))):(ck=ch[0],by.Dynamic(cm,L.Map2(function(cq,cr){return ck+cq+cr;},ch[1].$0,ch[1].$1.$0))):ch[0]===""?by.Dynamic(cm,ch[1].$0):(cl=ch[0],by.Dynamic(cm,L.Map(function(cq){return cl+cq;},ch[1].$0))):U.Create(cm,ch[0]));}());});return[bR.DeleteEmptyFields({Els:bX,Dirty:true,Holes:b3,Attrs:b5,Render:(bY=b6.length==0?null:{$:1,$0:function(b_){P.iter(function(b$){b$(b_);},b6);}},bY?bY.$0:void 0),El:(bZ=!E.Equals(bX,null)&&bX.length===1&&(P.get(bX,0)instanceof D&&(P.get(bX,0)instanceof a.Element&&(b0=P.get(bX,0),true)))?{$:1,$0:b0}:null,bZ?bZ.$0:void 0)},["Render","El"]),bi.TreeReduce(L.Const(),L.Map2Unit,b4)];};$.GlobalHoles=function(){bm.$cctor();return bm.GlobalHoles;};$.foreachNotPreserved=function(bV,bW,bX){_4.IterSelector(bV,bW,function(bY){if(bY.closest("[ws-preserve]")==null)bX(bY);});};$.PrepareSingleTemplate=function(bV,bW,bX){var bY;bY=$.FakeRootSingle(bX);return function(bZ){$.PrepareTemplateStrict(bV,bW,bY,bZ);};};$.TextHoleRE=function(){bm.$cctor();return bm.TextHoleRE;};Y.head=function(bV){return bV.$==1?bV.$0:Y.listEmpty();};Y.tail=function(bV){return bV.$==1?bV.$1:Y.listEmpty();};Y.listEmpty=function(){return o.FailWith("The input list was empty.");};bb.New=function(bV,bW,bX,bY){var bZ;bZ={DynElem:bV,DynFlags:bW,DynNodes:bX};bR.SetOptional(bZ,"OnAfterRender",bY);return bZ;};bd.New=function(bV,bW){return{PreviousNodes:bV,Top:bW};};be.get_Empty=function(){return{$:0,$0:new W.New$3()};};be.FindAll=function(bV){var bW;function bX(b0,b1){var b2,b3,b4,b5,b6;while(true)switch(b0){case 0:if(b1!=null&&b1.$==0){b3=b1.$1;b4=b1.$0;bX(0,b4);b1=b3;}else if(b1!=null&&b1.$==1){b5=b1.$0;b1=b5;b0=1;}else if(b1!=null&&b1.$==2){b6=b1.$0;b1=b6.Current;}else return b1!=null&&b1.$==6?(b2=b1.$0.Holes,(function(b7){return function(b8){P.iter(b7,b8);};}(bZ))(b2)):null;break;case 1:bW.push(b1);b1=b1.Children;b0=0;break;}}function bY(b0){return bX(0,b0);}function bZ(b0){return bX(1,b0);}bW=[];bY(bV);return{$:0,$0:new W.New$2(bW)};};be.Filter=function(bV,bW){return{$:0,$0:bu.Filter(bV,bW.$0)};};be.Except=function(bV,bW){return{$:0,$0:bu.Except(bV.$0,bW.$0)};};be.ToArray=function(bV){return bu.ToArray(bV.$0);};be.Intersect=function(bV,bW){return{$:0,$0:bu.Intersect(bV.$0,bW.$0)};};bf.Delay=function(bV){return function(bW){try{(bV(null))(bW);}catch(bX){bW.k({$:1,$0:bX});}};};bf.Bind=function(bV,bW){return bf.checkCancel(function(bX){bV(br.New(function(bY){var bZ;if(bY.$==0){bZ=bY.$0;bf.scheduler().Fork(function(){try{(bW(bZ))(bX);}catch(b0){bX.k({$:1,$0:b0});}});}else bf.scheduler().Fork(function(){bX.k(bY);});},bX.ct));});};bf.Zero=function(){bs.$cctor();return bs.Zero;};bf.Start=function(bV,bW){var bX,bY;bX=(bY=(bf.defCTS())[0],bW==null?bY:bW.$0);bf.scheduler().Fork(function(){if(!bX.c)bV(br.New(function(bZ){if(bZ.$==1)bf.UncaughtAsyncError(bZ.$0);},bX));});};bf.Return=function(bV){return function(bW){bW.k({$:0,$0:bV});};};bf.scheduler=function(){bs.$cctor();return bs.scheduler;};bf.checkCancel=function(bV){return function(bW){if(bW.ct.c)bf.cancel(bW);else bV(bW);};};bf.defCTS=function(){bs.$cctor();return bs.defCTS;};bf.UncaughtAsyncError=function(bV){bS.log("WebSharper: Uncaught asynchronous exception",bV);};bf.FromContinuations=function(bV){return function(bW){var bX;function bY(bZ){if(bX[0])o.FailWith("A continuation provided by Async.FromContinuations was invoked multiple times");else{bX[0]=true;bf.scheduler().Fork(bZ);}}bX=[false];bV(function(bZ){bY(function(){bW.k({$:0,$0:bZ});});},function(bZ){bY(function(){bW.k({$:1,$0:bZ});});},function(bZ){bY(function(){bW.k({$:2,$0:bZ});});});};};bf.cancel=function(bV){bV.k({$:2,$0:new bI.New(bV.ct)});};bg.UseAnimations=function(){bk.$cctor();return bk.UseAnimations;};bg.Actions=function(bV){return bg.ConcatActions(P.choose(function(bW){return bW.$==1?{$:1,$0:bW.$0}:null;},bl.ToArray(bV.$0)));};bg.Finalize=function(bV){P.iter(function(bW){if(bW.$==0)bW.$0();},bl.ToArray(bV.$0));};bg.ConcatActions=function(bV){var bW,bX,bY,bZ;bW=bi.ofSeqNonCopying(bV);bX=P.length(bW);return bX===0?bg.Const():bX===1?P.get(bW,0):(bY=z.max(z.map(function(b0){return b0.Duration;},bW)),(bZ=P.map(function(b0){return bg.Prolong(bY,b0);},bW),bg.Def(bY,function(b0){P.iter(function(b1){b1.Compute(b0);},bZ);})));};bg.List=function(bV){return bV.$0;};bg.Const=function(bV){return bg.Def(0,function(){return bV;});};bg.Def=function(bV,bW){return{Compute:bW,Duration:bV};};bg.Prolong=function(bV,bW){var bX,bY,bZ;bX=bW.Compute;bY=bW.Duration;bZ=bJ.Create(function(){return bW.Compute(bW.Duration);});return{Compute:function(b0){return b0>=bY?bZ.f():bX(b0);},Duration:bV};};bh.$cctor=function(){bh.$cctor=a.ignore;bh.BatchUpdatesEnabled=true;};bi.mapInPlace=function(bV,bW){var bX,bY;for(bX=0,bY=bW.length-1;bX<=bY;bX++)bW[bX]=bV(bW[bX]);return bW;};bi.ofSeqNonCopying=function(bV){var bW,bX;if(bV instanceof a.Array)return bV;else if(bV instanceof Z)return P.ofList(bV);else if(bV===null)return[];else{bW=[];bX=_0.Get(bV);try{while(bX.MoveNext())bW.push(bX.Current());return bW;}finally{if(typeof bX=="object"&&"Dispose"in bX)bX.Dispose();}}};bi.TreeReduce=function(bV,bW,bX){var bY;function bZ(b0){return function(b1){var b2,b3;return b1<=0?bV:b1===1&&(b0>=0&&b0<bY)?P.get(bX,b0):(b3=b1/2>>0,bW((bZ(b0))(b3),(bZ(b0+b3))(b1-b3)));};}bY=P.length(bX);return(bZ(0))(bY);};bi.MapTreeReduce=function(bV,bW,bX,bY){var bZ;function b0(b1){return function(b2){var b3,b4;return b2<=0?bW:b2===1&&(b1>=0&&b1<bZ)?bV(P.get(bY,b1)):(b4=b2/2>>0,bX((b0(b1))(b4),(b0(b1+b4))(b2-b4)));};}bZ=P.length(bY);return(b0(0))(bZ);};bj.Insert=function(bV,bW){var bX,bY,bZ;function b0(b1){var b2,b3;while(true)if(!(b1===null)){if(b1!=null&&b1.$==1)return bX.push(b1.$0);else if(b1!=null&&b1.$==2){b2=b1.$1;b3=b1.$0;b0(b3);b1=b2;}else return b1!=null&&b1.$==3?b1.$0(bV):b1!=null&&b1.$==4?bY.push(b1.$0):null;}else return null;}bX=[];bY=[];b0(bW);bZ=bX.slice(0);return bb.New(bV,bj.Flags(bW),bZ,bY.length===0?null:{$:1,$0:function(b1){z.iter(function(b2){b2(b1);},bY);}});};bj.EmptyAttr=function(){bo.$cctor();return bo.EmptyAttr;};bj.HasExitAnim=function(bV){var bW;bW=2;return(bV.DynFlags&bW)===bW;};bj.GetExitAnim=function(bV){return bj.GetAnim(bV,function(bW,bX){return bW.NGetExitAnim(bX);});};bj.HasEnterAnim=function(bV){var bW;bW=1;return(bV.DynFlags&bW)===bW;};bj.GetEnterAnim=function(bV){return bj.GetAnim(bV,function(bW,bX){return bW.NGetEnterAnim(bX);});};bj.HasChangeAnim=function(bV){var bW;bW=4;return(bV.DynFlags&bW)===bW;};bj.GetChangeAnim=function(bV){return bj.GetAnim(bV,function(bW,bX){return bW.NGetChangeAnim(bX);});};bj.Flags=function(bV){return bV!==null&&bV.hasOwnProperty("flags")?bV.flags:0;};bj.GetAnim=function(bV,bW){return _5.Concat(P.map(function(bX){return bW(bX,bV.DynElem);},bV.DynNodes));};bj.Sync=function(bV,bW){P.iter(function(bX){bX.NSync(bV);},bW.DynNodes);};bj.Updates=function(bV){return bi.MapTreeReduce(function(bW){return bW.NChanged();},L.Const(),L.Map2Unit,bV.DynNodes);};bj.Empty=function(bV){return bb.New(bV,0,[],null);};bj.Static=function(bV){return new U({$:3,$0:bV});};bj.Dynamic=function(bV,bW){return new U({$:1,$0:new bN.New(bV,bW)});};bj.AppendTree=function(bV,bW){var bX;return bV===null?bW:bW===null?bV:(bX=new U({$:2,$0:bV,$1:bW}),(bj.SetFlags(bX,bj.Flags(bV)|bj.Flags(bW)),bX));};bj.SetFlags=function(bV,bW){bV.flags=bW;};bk.$cctor=function(){bk.$cctor=a.ignore;bk.CubicInOut=bq.Custom(function(bV){var bW;bW=bV*bV;return 3*bW-2*(bW*bV);});bk.UseAnimations=true;};bl.Append=function(bV,bW){return bV.$==0?bW:bW.$==0?bV:{$:2,$0:bV,$1:bW};};bl.ToArray=function(bV){var bW;function bX(bY){var bZ,b0;while(true)if(bY.$==1)return bW.push(bY.$0);else if(bY.$==2){bZ=bY.$1;b0=bY.$0;bX(b0);bY=bZ;}else return bY.$==3?P.iter(function(b1){bW.push(b1);},bY.$0):null;}bW=[];bX(bV);return bW.slice(0);};bl.Concat=function(bV){var bW;bW=bi.ofSeqNonCopying(bV);return bi.TreeReduce(bl.Empty(),bl.Append,bW);};bl.Empty=function(){bL.$cctor();return bL.Empty;};bm.$cctor=function(){bm.$cctor=a.ignore;bm.LoadedTemplates=new N.New$5();bm.LocalTemplatesLoaded=false;bm.GlobalHoles=new N.New$5();bm.TextHoleRE="\\${([^}]+)}";bm.RenderedFullDocTemplate=null;};bn=g.Elt=bR.Class({},r,bn);bn.TreeNode=function(bV,bW){var bX,bY;function bZ(b0,b1){return bj.Updates(b1);}bX=bA.Create(bW);return new bn.New$1({$:6,$0:bV},L.Map2Unit((bY=P.map(function(b0){return bZ(b0[0],b0[1]);},bV.Attrs),bi.TreeReduce(L.Const(),L.Map2Unit,bY)),bX.v),P.get(bV.Els,0),bX);};bn.New$1=bR.Ctor(function(bV,bW,bX,bY){r.New.call(this,bV,bW);this.docNode$1=bV;this.updates$1=bW;this.elt=bX;this.rvUpdates=bY;},bn);bo.$cctor=function(){var bV,bW,bX,bY,bZ,b0,b1,b2,b3,b4;bo.$cctor=a.ignore;bo.EmptyAttr=null;bo.BoolCheckedApply=function(b5){function b6(b7,b8){return b8!=null&&b8.$==1?void(b7.checked=b8.$0):null;}return[function(b7){b7.addEventListener("change",function(){return!E.Equals(b5.Get(),b7.checked)?b5.Set(b7.checked):null;});},function(b7){return function(b8){return b6(b7,b8);};},L.Map(function(b7){return{$:1,$0:b7};},b5.get_View())];};bo.StringSet=function(b5){return function(b6){b5.value=b6;};};bo.StringGet=function(b5){return{$:1,$0:b5.value};};bo.StringApply=(bV=bC.StringGet(),(bW=bC.StringSet(),function(b5){return bC.ApplyValue(bV,bW,b5);}));bo.IntSetUnchecked=function(b5){return function(b6){b5.value=a.String(b6);};};bo.IntGetUnchecked=function(b5){var b6,b7;b6=b5.value;return bD.isBlank(b6)?{$:1,$0:0}:(b7=+b6,b7!==b7>>0?null:{$:1,$0:b7});};bo.IntApplyUnchecked=(bX=bC.IntGetUnchecked(),(bY=bC.IntSetUnchecked(),function(b5){return bC.ApplyValue(bX,bY,b5);}));bo.IntSetChecked=function(b5){return function(b6){var b7;b7=b6.get_Input();return b5.value!==b7?void(b5.value=b7):null;};};bo.IntGetChecked=function(b5){var b6,b7,b8;b6=b5.value;return{$:1,$0:bD.isBlank(b6)?(b5.checkValidity?b5.checkValidity():true)?new V({$:2,$0:b6}):new V({$:1,$0:b6}):(b7=(b8=0,[R.TryParseInt32(b6,{get:function(){return b8;},set:function(b9){b8=b9;}}),b8]),b7[0]?new V({$:0,$0:b7[1],$1:b6}):new V({$:1,$0:b6}))};};bo.IntApplyChecked=(bZ=bC.IntGetChecked(),(b0=bC.IntSetChecked(),function(b5){return bC.ApplyValue(bZ,b0,b5);}));bo.FloatSetUnchecked=function(b5){return function(b6){b5.value=a.String(b6);};};bo.FloatGetUnchecked=function(b5){var b6,b7;b6=b5.value;return bD.isBlank(b6)?{$:1,$0:0}:(b7=+b6,a.isNaN(b7)?null:{$:1,$0:b7});};bo.FloatApplyUnchecked=(b1=bC.FloatGetUnchecked(),(b2=bC.FloatSetUnchecked(),function(b5){return bC.ApplyValue(b1,b2,b5);}));bo.FloatSetChecked=function(b5){return function(b6){var b7;b7=b6.get_Input();return b5.value!==b7?void(b5.value=b7):null;};};bo.FloatGetChecked=function(b5){var b6,b7;b6=b5.value;return{$:1,$0:bD.isBlank(b6)?(b5.checkValidity?b5.checkValidity():true)?new V({$:2,$0:b6}):new V({$:1,$0:b6}):(b7=+b6,a.isNaN(b7)?new V({$:1,$0:b6}):new V({$:0,$0:b7,$1:b6}))};};bo.FloatApplyChecked=(b3=bC.FloatGetChecked(),(b4=bC.FloatSetChecked(),function(b5){return bC.ApplyValue(b3,b4,b5);}));};bp=bf.Scheduler=bR.Class({Fork:function(bV){var bW;bW=this;this.robin.push(bV);if(this.idle){this.idle=false;a.setTimeout(function(){bW.tick();},0);}},tick:function(){var bV,bW,bX;bW=this;bX=bU.now();bV=true;while(bV)if(this.robin.length===0){this.idle=true;bV=false;}else{(this.robin.shift())();bU.now()-bX>40?(a.setTimeout(function(){bW.tick();},0),bV=false):void 0;}}},c,bp);bp.New=bR.Ctor(function(){c.New.call(this);this.idle=true;this.robin=[];},bp);bq=g.Easing=bR.Class({},c,bq);bq.Custom=function(bV){return new bq.New(bV);};bq.New=bR.Ctor(function(bV){c.New.call(this);this.transformTime=bV;},bq);br.New=function(bV,bW){return{k:bV,ct:bW};};bs.$cctor=function(){bs.$cctor=a.ignore;bs.noneCT=bt.New(false,[]);bs.scheduler=new bp.New();bs.defCTS=[new bE.New()];bs.Zero=bf.Return();bs.GetCT=function(bV){bV.k({$:0,$0:bV.ct});};};bt.New=function(bV,bW){return{c:bV,r:bW};};bu.Filter=function(bV,bW){return new W.New$2(P.filter(bV,bu.ToArray(bW)));};bu.Except=function(bV,bW){var bX;bX=new W.New$2(bu.ToArray(bW));bX.ExceptWith(bu.ToArray(bV));return bX;};bu.ToArray=function(bV){var bW;bW=P.create(bV.Count(),void 0);bV.CopyTo(bW);return bW;};bu.Intersect=function(bV,bW){var bX;bX=new W.New$2(bu.ToArray(bV));bX.IntersectWith(bu.ToArray(bW));return bX;};bv.convertTextNode=function(bV){var bW,bX,bY,bZ,b0,b1;bW=null;bX=0;bZ=bV.textContent;b0=new a.RegExp($.TextHoleRE(),"g");while(bW=b0.exec(bZ),bW!==null){bV.parentNode.insertBefore(self.document.createTextNode(bw.string(bZ,{$:1,$0:bX},{$:1,$0:b0.lastIndex-P.get(bW,0).length-1})),bV);bX=b0.lastIndex;b1=self.document.createElement("span");b1.setAttribute("ws-replace",P.get(bW,1).toLowerCase());bV.parentNode.insertBefore(b1,bV);}b0.lastIndex=0;bV.textContent=bw.string(bZ,{$:1,$0:bX},null);};bv.failNotLoaded=function(bV){bS.warn("Instantiating non-loaded template",bV);};bv.fillTextHole=function(bV,bW,bX){var bY;bY=bV.querySelector("[ws-replace]");return E.Equals(bY,null)?(bS.warn("Filling non-existent text hole",bX),null):(bY.parentNode.replaceChild(self.document.createTextNode(bW),bY),{$:1,$0:bY.getAttribute("ws-replace")});};bv.removeHolesExcept=function(bV,bW){function bX(bY){$.foreachNotPreserved(bV,"["+bY+"]",function(bZ){if(!bW.Contains(bZ.getAttribute(bY)))bZ.removeAttribute(bY);});}bX("ws-attr");bX("ws-onafterrender");bX("ws-var");$.foreachNotPreserved(bV,"[ws-hole]",function(bY){if(!bW.Contains(bY.getAttribute("ws-hole"))){bY.removeAttribute("ws-hole");while(bY.hasChildNodes())bY.removeChild(bY.lastChild);}});$.foreachNotPreserved(bV,"[ws-replace]",function(bY){if(!bW.Contains(bY.getAttribute("ws-replace")))bY.parentNode.removeChild(bY);});$.foreachNotPreserved(bV,"[ws-on]",function(bY){bY.setAttribute("ws-on",bz.concat(" ",P.filter(function(bZ){return bW.Contains(P.get(bz.SplitChars(bZ,[":"],1),1));},bz.SplitChars(bY.getAttribute("ws-on"),[" "],1))));});$.foreachNotPreserved(bV,"[ws-attr-holes]",function(bY){var bZ,b0,b1,b2,b3;bZ=bz.SplitChars(bY.getAttribute("ws-attr-holes"),[" "],1);for(b0=0,b1=bZ.length-1;b0<=b1;b0++){b2=P.get(bZ,b0);bY.setAttribute(b2,(b3=new a.RegExp($.TextHoleRE(),"g"),bY.getAttribute(b2).replace(b3,function(b4,b5){return bW.Contains(b5)?b4:"";})));}});};bv.fillInstanceAttrs=function(bV,bW){var bX,bY,bZ,b0,b1;bv.convertAttrs(bW);bX=bW.nodeName.toLowerCase();bY=bV.querySelector("[ws-attr="+bX+"]");if(E.Equals(bY,null))bS.warn("Filling non-existent attr hole",bX);else{bY.removeAttribute("ws-attr");for(bZ=0,b0=bW.attributes.length-1;bZ<=b0;bZ++){b1=bW.attributes.item(bZ);if(b1.name==="class"&&bY.hasAttribute("class"))bY.setAttribute("class",bY.getAttribute("class")+" "+b1.nodeValue);else bY.setAttribute(b1.name,b1.nodeValue);}}};bv.mapHoles=function(bV,bW){function bX(bY){$.foreachNotPreserved(bV,"["+bY+"]",function(bZ){var b0,b1;b0=(b1=null,[bW.TryGetValue(bZ.getAttribute(bY).toLowerCase(),{get:function(){return b1;},set:function(b2){b1=b2;}}),b1]);if(b0[0])bZ.setAttribute(bY,b0[1]);});}bX("ws-hole");bX("ws-replace");bX("ws-attr");bX("ws-onafterrender");bX("ws-var");$.foreachNotPreserved(bV,"[ws-on]",function(bY){bY.setAttribute("ws-on",bz.concat(" ",P.map(function(bZ){var b0,b1,b2;b0=bz.SplitChars(bZ,[":"],1);b1=(b2=null,[bW.TryGetValue(P.get(b0,1),{get:function(){return b2;},set:function(b3){b2=b3;}}),b2]);return b1[0]?P.get(b0,0)+":"+b1[1]:bZ;},bz.SplitChars(bY.getAttribute("ws-on"),[" "],1))));});$.foreachNotPreserved(bV,"[ws-attr-holes]",function(bY){var bZ,b0,b1;bZ=bz.SplitChars(bY.getAttribute("ws-attr-holes"),[" "],1);for(b0=0,b1=bZ.length-1;b0<=b1;b0++)(function(){var b2;function b3(b4,b5){var b6;b6=o.KeyValue(b5);return b4.replace(new a.RegExp("\\${"+b6[0]+"}","ig"),"${"+b6[1]+"}");}b2=P.get(bZ,b0);return bY.setAttribute(b2,(((bR.Curried3(z.fold))(b3))(bY.getAttribute(b2)))(bW));}());});};bv.fill=function(bV,bW,bX){while(true)if(bV.hasChildNodes())bX=bW.insertBefore(bV.lastChild,bX);else return null;};bv.convertAttrs=function(bV){var bX,bY,bZ,b0,b1,b2,b3,b4;function bW(b5){var b6;b6=bV.getAttribute(b5);if(b6===null);else bV.setAttribute(b5,b6.toLowerCase());}bX=bV.attributes;bY=[];bZ=[];b0=[];for(b1=0,b2=bX.length-1;b1<=b2;b1++){b3=bX.item(b1);if(bz.StartsWith(b3.nodeName,"ws-on")&&b3.nodeName!=="ws-onafterrender"&&b3.nodeName!=="ws-on"){bY.push(b3.nodeName);bZ.push(bw.string(b3.nodeName,{$:1,$0:"ws-on".length},null)+":"+b3.nodeValue.toLowerCase());}else!bz.StartsWith(b3.nodeName,"ws-")&&(new a.RegExp($.TextHoleRE())).test(b3.nodeValue)?(b3.nodeValue=(b4=new a.RegExp($.TextHoleRE(),"g"),b3.nodeValue.replace(b4,function(b5,b6){return"${"+b6.toLowerCase()+"}";})),b0.push(b3.nodeName)):void 0;}if(!(bZ.length==0))bV.setAttribute("ws-on",bz.concat(" ",bZ));if(!(b0.length==0))bV.setAttribute("ws-attr-holes",bz.concat(" ",b0));bW("ws-hole");bW("ws-replace");bW("ws-attr");bW("ws-onafterrender");bW("ws-var");P.iter(function(b5){bV.removeAttribute(b5);},bY);};bw.string=function(bV,bW,bX){var bY,bZ;return bW==null?bX!=null&&bX.$==1?(bY=bX.$0,bY<0?"":bV.slice(0,bY+1)):"":bX==null?bV.slice(bW.$0):(bZ=bX.$0,bZ<0?"":bV.slice(bW.$0,bZ+1));};z.insufficient=function(){return o.FailWith("The input sequence has an insufficient number of elements.");};bx=M.KeyCollection=bR.Class({},c,bx);bx.New=bR.Ctor(function(bV){c.New.call(this);this.d=bV;},bx);by.Handler=function(bV,bW){return bj.Static(function(bX){bX.addEventListener(bV,function(bY){return(bW(bX))(bY);},false);});};by.OnAfterRender=function(bV){return new U({$:4,$0:bV});};by.Value=function(bV){return by.ValueWith(bC.StringApply(),bV);};by.Checked=function(bV){return by.ValueWith(bC.BoolCheckedApply(),bV);};by.IntValue=function(bV){return by.ValueWith(bC.IntApplyChecked(),bV);};by.IntValueUnchecked=function(bV){return by.ValueWith(bC.IntApplyUnchecked(),bV);};by.FloatValue=function(bV){return by.ValueWith(bC.FloatApplyChecked(),bV);};by.FloatValueUnchecked=function(bV){return by.ValueWith(bC.FloatApplyUnchecked(),bV);};by.Dynamic=function(bV,bW){return bj.Dynamic(bW,function(bX){return function(bY){return bX.setAttribute(bV,bY);};});};by.ValueWith=function(bV,bW){var bX;bX=bV(bW);return U.Append(bj.Static(bX[0]),by.DynamicCustom(bX[1],bX[2]));};by.DynamicCustom=function(bV,bW){return bj.Dynamic(bW,bV);};bz.concat=function(bV,bW){return P.ofSeq(bW).join(bV);};bz.SplitChars=function(bV,bW,bX){return bz.Split(bV,new a.RegExp("["+bz.RegexEscape(bW.join(""))+"]"),bX);};bz.StartsWith=function(bV,bW){return bV.substring(0,bW.length)==bW;};bz.forall=function(bV,bW){return z.forall(bV,bz.protect(bW));};bz.Split=function(bV,bW,bX){return bX===1?P.filter(function(bY){return bY!=="";},bz.SplitWith(bV,bW)):bz.SplitWith(bV,bW);};bz.RegexEscape=function(bV){return bV.replace(new a.RegExp("[-\\/\\\\^$*+?.()|[\\]{}]","g"),"\\$&");};bz.protect=function(bV){return bV===null?"":bV;};bz.SplitWith=function(bV,bW){return bV.split(bW);};bA=g.Updates=bR.Class({},null,bA);bA.Create=function(bV){var bW;bW=null;bW=bA.New(bV,null,function(){var bX;bX=bW.s;return bX===null?(bX=q.Copy(bW.c()),bW.s=bX,q.WhenObsoleteRun(bX,function(){bW.s=null;}),bX):bX;});return bW;};bA.New=function(bV,bW,bX){return new bA({c:bV,s:bW,v:bX});};bB=M.ValueCollection=bR.Class({},c,bB);bB.New=bR.Ctor(function(bV){c.New.call(this);this.d=bV;},bB);bC.ApplyValue=function(bV,bW,bX){var bY;function bZ(b0,b1){return b1==null?null:b0(b1.$0);}bY=null;return[function(b0){function b1(){bX.UpdateMaybe(function(b2){var b3;bY=bV(b0);return bY!=null&&bY.$==1&&(!E.Equals(bY.$0,b2)&&(b3=[bY,bY.$0],true))?b3[0]:null;});}b0.addEventListener("change",b1);b0.addEventListener("input",b1);b0.addEventListener("keypress",b1);},function(b0){var b1;b1=bW(b0);return function(b2){return bZ(b1,b2);};},L.Map(function(b0){var b1;return bY!=null&&bY.$==1&&(E.Equals(bY.$0,b0)&&(b1=bY.$0,true))?null:{$:1,$0:b0};},bX.get_View())];};bC.StringSet=function(){bo.$cctor();return bo.StringSet;};bC.StringGet=function(){bo.$cctor();return bo.StringGet;};bC.IntSetUnchecked=function(){bo.$cctor();return bo.IntSetUnchecked;};bC.IntGetUnchecked=function(){bo.$cctor();return bo.IntGetUnchecked;};bC.IntSetChecked=function(){bo.$cctor();return bo.IntSetChecked;};bC.IntGetChecked=function(){bo.$cctor();return bo.IntGetChecked;};bC.FloatSetUnchecked=function(){bo.$cctor();return bo.FloatSetUnchecked;};bC.FloatGetUnchecked=function(){bo.$cctor();return bo.FloatGetUnchecked;};bC.FloatSetChecked=function(){bo.$cctor();return bo.FloatSetChecked;};bC.FloatGetChecked=function(){bo.$cctor();return bo.FloatGetChecked;};bC.StringApply=function(){bo.$cctor();return bo.StringApply;};bC.BoolCheckedApply=function(){bo.$cctor();return bo.BoolCheckedApply;};bC.IntApplyChecked=function(){bo.$cctor();return bo.IntApplyChecked;};bC.IntApplyUnchecked=function(){bo.$cctor();return bo.IntApplyUnchecked;};bC.FloatApplyChecked=function(){bo.$cctor();return bo.FloatApplyChecked;};bC.FloatApplyUnchecked=function(){bo.$cctor();return bo.FloatApplyUnchecked;};bD.isBlank=function(bV){return bz.forall(bG.IsWhiteSpace,bV);};bE=b.CancellationTokenSource=bR.Class({},c,bE);bE.New=bR.Ctor(function(){c.New.call(this);this.c=false;this.pending=null;this.r=[];this.init=1;},bE);bF.Children=function(bV,bW){var bX,bY,bZ;if(bW!=null&&bW.$==1){bZ=[];bX=bW.$0[0].nextSibling;while(bX!==bW.$0[1]){bZ.push(bX);bX=bX.nextSibling;}return{$:0,$0:bZ};}else return{$:0,$0:P.init(bV.childNodes.length,(bY=bV.childNodes,function(b0){return bY[b0];}))};};bF.Except=function(bV,bW){var bX;bX=bV.$0;return{$:0,$0:P.filter(function(bY){return P.forall(function(bZ){return!(bY===bZ);},bX);},bW.$0)};};bF.Iter=function(bV,bW){P.iter(bV,bW.$0);};bF.DocChildren=function(bV){var bW;function bX(bY){var bZ,b0,b1,b2;while(true){if(bY!=null&&bY.$==2){b0=bY.$0;bY=b0.Current;}else if(bY!=null&&bY.$==1)return bW.push(bY.$0.El);else if(bY==null)return null;else if(bY!=null&&bY.$==5)return bW.push(bY.$0);else if(bY!=null&&bY.$==4)return bW.push(bY.$0.Text);else if(bY!=null&&bY.$==6){bZ=bY.$0.Els;return(function(b3){return function(b4){P.iter(b3,b4);};}(function(b3){if(b3==null||b3.constructor===I)bX(b3);else bW.push(b3);}))(bZ);}else{b1=bY.$1;b2=bY.$0;bX(b2);bY=b1;}}}bW=[];bX(bV.Children);return{$:0,$0:bi.ofSeqNonCopying(bW)};};bG.IsWhiteSpace=function(bV){return bV.match(new a.RegExp("\\s"))!==null;};R.TryParse=function(bV,bW,bX,bY){var bZ,b0;bZ=+bV;b0=bZ===bZ-bZ%1&&bZ>=bW&&bZ<=bX;if(b0)bY.set(bZ);return b0;};bI=b.OperationCanceledException=bR.Class({},bH,bI);bI.New=bR.Ctor(function(bV){bI.New$1.call(this,"The operation was canceled.",null,bV);},bI);bI.New$1=bR.Ctor(function(bV,bW,bX){this.message=bV;this.inner=bW;I.setPrototypeOf(this,bI.prototype);this.ct=bX;},bI);bJ.Create=function(bV){return bQ.New(false,bV,bJ.forceLazy);};bJ.forceLazy=function(){var bV;bV=this.v();this.c=true;this.v=bV;this.f=bJ.cachedLazy;return bV;};bJ.cachedLazy=function(){return this.v;};bK.concat=function(bV){var bW,bX;bW=[];for(var bY in bV)bW.push.apply(bW,bV[bY]);return bW;};bL.$cctor=function(){bL.$cctor=a.ignore;bL.Empty={$:0};};bM.$cctor=function(){var bV;bM.$cctor=a.ignore;bM.rxhtmlTag=new a.RegExp("<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\\w:]+)[^>]*)\\/>","gi");bM.rtagName=new a.RegExp("<([\\w:]+)");bM.rhtml=new a.RegExp("<|&#?\\w+;");bM.wrapMap=(bV=[1,"<table>","</table>"],{option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:bV,tbody:bV,tfoot:bV,tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><colgroup>","</colgoup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"]});bM.defaultWrap=[0,"",""];};bN=g.DynamicAttrNode=bR.Class({NGetExitAnim:function(bV){return _5.get_Empty();},NGetEnterAnim:function(bV){return _5.get_Empty();},NGetChangeAnim:function(bV){return _5.get_Empty();},NSync:function(bV){if(this.dirty){(this.push(bV))(this.value);this.dirty=false;}},NChanged:function(){return this.updates;}},c,bN);bN.New=bR.Ctor(function(bV,bW){var bX;bX=this;c.New.call(this);this.push=bW;this.value=void 0;this.dirty=false;this.updates=L.Map(function(bY){bX.value=bY;bX.dirty=true;},bV);},bN);bO.Clear=function(bV){bV.splice(0,P.length(bV));};bQ.New=function(bV,bW,bX){return{c:bV,v:bW,f:bX};};bR.OnLoad(function(){f.ClientMain();});}(self));


if (typeof WebSharper !=='undefined') {
  WebSharper.Runtime.ScriptBasePath = '/Content/';
  WebSharper.Runtime.Start();
}
