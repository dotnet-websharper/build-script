(function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;b=a.WebSharper=a.WebSharper||{};c=b.UI=b.UI||{};d=c.ViewExtensions=c.ViewExtensions||{};e=c.DocExtension=c.DocExtension||{};f=c.Client=c.Client||{};g=f.Helpers=f.Helpers||{};h=b&&b.Obj;i=f.RouteMapBuilder=f.RouteMapBuilder||{};j=f.RouteItemParsers=f.RouteItemParsers||{};k=c&&c.View;l=c&&c.Doc;m=c&&c.Var$1;n=b&&b.List;o=b&&b.Runtime;p=c&&c.RouteMap;q=b&&b.Seq;r=b&&b.Unchecked;s=b&&b.Arrays;t=b&&b.Collections;u=t&&t.Map;v=b&&b.Nullable;w=b&&b.Operators;x=t&&t.FSharpMap;y=b&&b.Option;d.WithInit=function(z,A){return k.WithInit(A,z);};d.UpdateWhile=function(z,A,B){return k.UpdateWhile(A,B,z);};e.DocLens=function(z,A){return l.Flatten(z.MapLens(A));};e.Doc=function(z,A){return l.ConvertSeqBy(z.key,function(B){return function(C){return A(B,C);};},z["var"].get_View());};e.Doc$1=function(z,A){return l.ConvertBy(z.key,A,z["var"].get_View());};e.DocLens$1=function(z,A,B){return l.ConvertSeqVarBy(A,B,z);};e.DocSeqCached=function(z,A,B){return l.ConvertSeqBy(A,function(C){return function(D){return B(C,D);};},z);};g.seqRefToListRef=function(z){return m.Lens(z,n.ofSeq,function(A,B){return B;});};i=f.RouteMapBuilder=o.Class({Install:function(){var z,A;function B(C,D){return C(function(E){return m.Set(z,E);},D);}z=p.Install(this.ToRouteMap());A=n.map(function(C){return function(D){return B(C,D);};},n.rev(this.renders));return l.BindView(function(C){return q.pick(function(D){return D(C);},A);},z.get_View());},ToRouteMap:function(){var z,A;z=n.rev(this.links);A=n.rev(this.routes);return p.CreateWithQuery(function(B){return q.pick(function(C){return C(B);},z);},function(B){return q.pick(function(C){return C(B);},A);});},AddRender:function(z){this.renders=new n.T({$:1,$0:z,$1:this.renders});},AddLink:function(z){this.links=new n.T({$:1,$0:z,$1:this.links});},AddRoute:function(z){this.routes=new n.T({$:1,$0:z,$1:this.routes});}},h,i);i.New=o.Ctor(function(){h.New.call(this);this.links=n.T.Empty;this.routes=n.T.Empty;this.renders=n.T.Empty;},i);j["System.Double"]=function(z){var A,B;A=z[0];return A.$==1?(B=(new a.RegExp("^[0-9](?:\\.[0-9]*)?$")).exec(A.$0),r.Equals(B,null)?null:{$:1,$0:[a.parseFloat(s.get(B,0)),A.$1]}):null;};j["System.Int32"]=function(z){var A,B;A=z[0];return A.$==1?(B=(new a.RegExp("^[0-9]+$")).exec(A.$0),r.Equals(B,null)?null:{$:1,$0:[a.parseInt(s.get(B,0),a.$radix),A.$1]}):null;};j["System.String"]=function(z){var A;A=z[0];return A.$==1?{$:1,$0:[A.$0,A.$1]}:null;};j.MakeLink=function(z){return function(A){var B,C;function D(G,H,I,J){var K,L,M,N,O,P;return r.Equals(H,0)?(K=J(A[G]),(B[0]=u.FoldBack(function(Q,R,S){return S.Add$1(Q,R);},K[1],B[0]),K[0])):r.Equals(H,1)?(B[0]=(L=n.head((J(A[G]))[0]),B[0].Add$1(G,L)),n.T.Empty):r.Equals(H,2)?(M=A[G],M!=null&&M.$==1?B[0]=(N=n.head((J(M.$0))[0]),B[0].Add$1(G,N)):void 0,n.T.Empty):r.Equals(H,3)?(O=A[G],(O!=null?B[0]=(P=n.head((J(v.get(O)))[0]),B[0].Add$1(G,P)):void 0,n.T.Empty)):w.FailWith("invalid QueryItem enum value");}function E(G){return G[0];}function F(G,H){return function(I){return(H(I))[0];};}return z.$==1?(B=[new x.New([])],[n.append(y.toList(z.$1),n.ofSeq(q.collect(function(G){return D(G[0],G[1],G[2],G[3]);},z.$2))),B[0]]):z.$==2?[new n.T({$:1,$0:a.String(q.length(A)),$1:n.ofSeq(q.collect((C=z.$2,function(G){return E(C(G));}),A))}),new x.New([])]:z.$==3?[n.ofSeq(q.concat((((o.Curried3(q.map2))(function(G,H){return(function(I){return F(I[0],I[1]);}(G))(H);}))(z.$0))(A))),new x.New([])]:[n.ofArray([a.String(A)]),new x.New([])];};};j.ParseRoute=function(z){var A,B;function C(D,E){return E.$==0?{$:1,$0:D}:null;}A=j.ParseShape(z);B=function(D){var E;return D==null?null:(E=D.$0,C(E[0],E[1]));};return function(D){return B(A(D));};};j.ParseShape=function(z){return function(A){var B,C,D,E,F,G,H,I,J,K,L,M;function N(Q,R,S){var T,U;function V(W,X){var Y,Z,_0,_1,_2,_3,_4,_5,_6,_7;Y=X[0];Z=X[1];_0=X[2];return W!=null&&W.$==1?(_1=W.$0,r.Equals(Z,0)?(_2=_0([_1,C]),_2!=null&&_2.$==1?(T[Y]=_2.$0[0],{$:1,$0:_2.$0[1]}):null):r.Equals(Z,1)?(_3=u.TryFind(Y,C),_3==null?null:(T[Y]=_3.$0,{$:1,$0:_1})):r.Equals(Z,2)?(_4=u.TryFind(Y,C),_4!=null&&_4.$==1?(_5=_0([n.ofArray([_4.$0]),new x.New([])]),_5!=null&&_5.$==1?(T[Y]={$:1,$0:_5.$0[0]},{$:1,$0:_1}):null):(T[Y]=null,{$:1,$0:_1})):r.Equals(Z,3)?(_6=u.TryFind(Y,C),_6!=null&&_6.$==1?(_7=_0([n.ofArray([_6.$0]),new x.New([])]),_7!=null&&_7.$==1?(T[Y]=_7.$0[0],{$:1,$0:_1}):null):(T[Y]=null,{$:1,$0:_1})):w.FailWith("invalid QueryItem enum value")):null;}T=Q();U=(((o.Curried3(s.fold))(V))({$:1,$0:R}))(S);return U==null?null:{$:1,$0:[T,U.$0]};}function O(Q,R){var S;while(true)if(Q===I)return{$:1,$0:[E(K),R]};else{S=F([R,C]);if(S!=null&&S.$==1){s.set(K,Q,S.$0[0]);Q=Q+1;R=S.$0[1];}else return null;}}function P(Q,R){var S,T,U,V;return Q==null?null:(S=R[0]([Q.$0,C]),S==null?null:{$:1,$0:(T=S.$0,(U=T[0],(V=T[1],(L.push(U),V))))});}B=A[0];C=A[1];return z.$==1?z.$1==null?N(z.$0,B,z.$2):B.$==1&&(B.$0===z.$1.$0&&(D=[B.$1,B.$0],true))?N(z.$0,D[0],z.$2):null:z.$==2?(E=z.$0,(F=z.$1,(G=j["System.Int32"]([B,C]),G==null?null:(H=G.$0,(I=H[0],(J=H[1],(K=s.create(I,null),O(0,J)))))))):z.$==3?(L=[],(M=(((o.Curried3(s.fold))(P))({$:1,$0:B}))(z.$0),M==null?null:{$:1,$0:[L,M.$0]})):z.$0([B,C]);};};}(self));
