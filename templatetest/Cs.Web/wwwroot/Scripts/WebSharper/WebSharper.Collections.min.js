(function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I;b=a.WebSharper=a.WebSharper||{};c=b.Collections=b.Collections||{};d=c.BalancedTree=c.BalancedTree||{};e=d.Tree=d.Tree||{};f=c.Pair=c.Pair||{};g=c.MapUtil=c.MapUtil||{};h=b&&b.Obj;i=c.FSharpMap=c.FSharpMap||{};j=c.Map=c.Map||{};k=c.FSharpSet=c.FSharpSet||{};l=c.Set=c.Set||{};m=c.ListEnumerator=c.ListEnumerator||{};n=c.List=c.List||{};o=c.LinkedListEnumerator=c.LinkedListEnumerator||{};p=c.LinkedList=c.LinkedList||{};q=b.Grouping=b.Grouping||{};r=b.FsComparer=b.FsComparer||{};s=b.ProjectionComparer=b.ProjectionComparer||{};t=b.CompoundComparer=b.CompoundComparer||{};u=b.ReverseComparer=b.ReverseComparer||{};v=b.OrderedEnumerable=b.OrderedEnumerable||{};w=b.Linq=b.Linq||{};x=b.Query=b.Query||{};y=c&&c.Dictionary;z=b&&b.Enumerator;A=b&&b.Arrays;B=b&&b.Seq;C=b&&b.Unchecked;D=b&&b.List;E=b&&b.Runtime;F=b&&b.Operators;G=c&&c.HashSet;H=b&&b.Nullable;I=b&&b.Option;c.dict=function(J){var K,L,M;K=new y.New$5();L=z.Get(J);try{while(L.MoveNext()){M=L.Current();K.DAdd(M[0],M[1]);}}finally{if(typeof L=="object"&&"Dispose"in L)L.Dispose();}return K;};e.New=function(J,K,L,M,N){return{Node:J,Left:K,Right:L,Height:M,Count:N};};d.TryFind=function(J,K){var L;L=(d.Lookup(J,K))[0];return L==null?null:{$:1,$0:L.Node};};d.Contains=function(J,K){return!((d.Lookup(J,K))[0]==null);};d.Add=function(J,K){return d.Put(function(L,M){return M;},J,K);};d.Remove=function(J,K){var L,M,N,O;L=d.Lookup(J,K);M=L[0];N=L[1];return M==null?K:M.Right==null?d.Rebuild(N,M.Left):M.Left==null?d.Rebuild(N,M.Right):d.Rebuild(N,(O=A.ofSeq(B.append(d.Enumerate(false,M.Left),d.Enumerate(false,M.Right))),d.Build(O,0,O.length-1)));};d.Put=function(J,K,L){var M,N;M=d.Lookup(K,L);N=M[0];return N==null?d.Rebuild(M[1],d.Branch(K,null,null)):d.Rebuild(M[1],d.Branch(J(N.Node,K),N.Left,N.Right));};d.Rebuild=function(J,K){var L,N,O,P,Q,R,S,T,U,V;function M(W){return W==null?0:W.Height;}L=K;for(N=0,O=A.length(J)-1;N<=O;N++){L=(P=A.get(J,N),P[0]?(Q=P[1],(R=P[2],M(L)>M(R)+1?M(L.Left)===M(L.Right)+1?(S=L.Left,d.Branch(S.Node,d.Branch(Q,R,S.Left),d.Branch(L.Node,S.Right,L.Right))):d.Branch(L.Node,d.Branch(Q,R,L.Left),L.Right):d.Branch(Q,R,L))):(T=P[1],(U=P[2],M(L)>M(U)+1?M(L.Right)===M(L.Left)+1?(V=L.Right,d.Branch(V.Node,d.Branch(L.Node,L.Left,V.Left),d.Branch(T,V.Right,U))):d.Branch(L.Node,L.Left,d.Branch(T,L.Right,U)):d.Branch(T,L,U))));}return L;};d.Lookup=function(J,K){var L,M,N,O;L=[];M=K;N=true;while(N)if(M==null)N=false;else{O=C.Compare(J,M.Node);if(O===0)N=false;else O===1?(L.unshift([true,M.Node,M.Left]),M=M.Right):(L.unshift([false,M.Node,M.Right]),M=M.Left);}return[M,L];};d.OfSeq=function(J){var K;K=A.ofSeq(B.distinct(J));A.sortInPlace(K);return d.Build(K,0,K.length-1);};d.Build=function(J,K,L){var M,N,O;return L-K+1<=0?null:(M=(K+L)/2>>0,(N=d.Build(J,K,M-1),(O=d.Build(J,M+1,L),d.Branch(A.get(J,M),N,O))));};d.Enumerate=function(J,K){function L(M,N){var O;while(true)if(M==null)return N.$==1?{$:1,$0:[N.$0[0],[N.$0[1],N.$1]]}:null;else if(J){O=M;M=O.Right;N=new D.T({$:1,$0:[O.Node,O.Left],$1:N});}else{O=M;M=O.Left;N=new D.T({$:1,$0:[O.Node,O.Right],$1:N});}}return B.unfold(function(M){return L(M[0],M[1]);},[K,D.T.Empty]);};d.Branch=function(J,K,L){var M,N;return e.New(J,K,L,1+(M=K==null?0:K.Height,(N=L==null?0:L.Height,C.Compare(M,N)===1?M:N)),1+(K==null?0:K.Count)+(L==null?0:L.Count));};f=c.Pair=E.Class({Equals:function(J){return C.Equals(this.Key,J.Key);},GetHashCode:function(){return C.Hash(this.Key);},CompareTo0:function(J){return C.Compare(this.Key,J.Key);}},null,f);f.New=function(J,K){return new f({Key:J,Value:K});};g.fromSeq=function(J){var K;K=A.ofSeq(B.map(function(L){return f.New(L[0],L[1]);},B.distinctBy(function(L){return L[0];},B.rev(J))));A.sortInPlace(K);return d.Build(K,0,K.length-1);};i=c.FSharpMap=E.Class({GetEnumerator:function(){return z.Get(B.map(function(J){return{K:J.Key,V:J.Value};},d.Enumerate(false,this.tree)));},Count:function(){var J;J=this.tree;return J==null?0:J.Count;},Equals:function(J){return this.Count()===J.Count()&&B.forall2(C.Equals,this,J);},GetHashCode:function(){return C.Hash(A.ofSeq(this));},get_Values:function(){return E.MarkResizable(A.ofSeq(B.map(function(J){return J.Value;},d.Enumerate(false,this.get_Tree()))));},get_Keys:function(){return E.MarkResizable(A.ofSeq(B.map(function(J){return J.Key;},d.Enumerate(false,this.get_Tree()))));},TryFind:function(J){var K;K=d.TryFind(f.New(J,void 0),this.tree);return K==null?null:{$:1,$0:K.$0.Value};},Remove$1:function(J){return new i.New$1(d.Remove(f.New(J,void 0),this.tree));},get_Item:function(J){var K;K=this.TryFind(J);return K==null?F.FailWith("The given key was not present in the dictionary."):K.$0;},get_IsEmpty:function(){return this.tree==null;},TryGetValue:function(J,K){var L;L=this.TryFind(J);return L!=null&&L.$==1&&(K.set(L.$0),true);},ContainsKey:function(J){return d.Contains(f.New(J,void 0),this.tree);},Add$1:function(J,K){return new i.New$1(d.Add(f.New(J,K),this.tree));},get_Tree:function(){return this.tree;},Remove:function(J){return F.FailWith("Map values cannot be mutated.");},CopyTo:function(J,K){z.ArrayCopyTo(A.ofSeq(this),J,K);},Contains:function(J){var K;K=void 0;return this.TryGetValue(J.K,{get:function(){return K;},set:function(L){K=L;}})&&C.Equals(K,J.V);},Clear:function(){F.FailWith("Map values cannot be mutated.");},Add:function(J){F.FailWith("Map values cannot be mutated.");},IsReadOnly:function(){return true;},CompareTo0:function(J){return B.compareWith(C.Compare,this,J);}},h,i);i.New=E.Ctor(function(J){i.New$1.call(this,g.fromSeq(J));},i);i.New$1=E.Ctor(function(J){h.New.call(this);this.tree=J;},i);j.Values=function(J){return J.get_Values();};j.Keys=function(J){return J.get_Keys();};j.Map=function(J,K){return new i.New$1(d.OfSeq(B.map(function(L){return f.New(L.Key,J(L.Key,L.Value));},d.Enumerate(false,K.get_Tree()))));};j.TryPick=function(J,K){return B.tryPick(function(L){return J(L.K,L.V);},K);};j.TryFindKey=function(J,K){return B.tryPick(function(L){return J(L.K,L.V)?{$:1,$0:L.K}:null;},K);};j.TryFind=function(J,K){return K.TryFind(J);};j.ToSeq=function(J){return B.map(function(K){return[K.Key,K.Value];},d.Enumerate(false,J.get_Tree()));};j.Pick=function(J,K){return B.pick(function(L){return J(L.K,L.V);},K);};j.Partition=function(J,K){var L,M,N;L=A.partition(function(O){return J(O.Key,O.Value);},A.ofSeq(d.Enumerate(false,K.get_Tree())));return[new i.New$1((M=L[0],d.Build(M,0,M.length-1))),new i.New$1((N=L[1],d.Build(N,0,N.length-1)))];};j.OfArray=function(J){return new i.New$1(d.OfSeq(B.map(function(K){return f.New(K[0],K[1]);},J)));};j.Iterate=function(J,K){B.iter(function(L){J(L.K,L.V);},K);};j.ForAll=function(J,K){return B.forall(function(L){return J(L.K,L.V);},K);};j.FoldBack=function(J,K,L){return B.fold(function(M,N){return J(N.Key,N.Value,M);},L,d.Enumerate(true,K.get_Tree()));};j.Fold=function(J,K,L){return B.fold(function(M,N){return J(M,N.Key,N.Value);},K,d.Enumerate(false,L.get_Tree()));};j.FindKey=function(J,K){return B.pick(function(L){return J(L.K,L.V)?{$:1,$0:L.K}:null;},K);};j.Filter=function(J,K){var L;return new i.New$1((L=A.ofSeq(B.filter(function(M){return J(M.Key,M.Value);},d.Enumerate(false,K.get_Tree()))),d.Build(L,0,L.length-1)));};j.Exists=function(J,K){return B.exists(function(L){return J(L.K,L.V);},K);};k=c.FSharpSet=E.Class({GetEnumerator:function(){return z.Get(d.Enumerate(false,this.tree));},Count:function(){var J;J=this.tree;return J==null?0:J.Count;},Equals:function(J){return this.Count()===J.Count()&&B.forall2(C.Equals,this,J);},GetHashCode:function(){return -1741749453+C.Hash(A.ofSeq(this));},Remove$1:function(J){return new k.New$1(d.Remove(J,this.tree));},get_MinimumElement:function(){return B.head(d.Enumerate(false,this.tree));},get_MaximumElement:function(){return B.head(d.Enumerate(true,this.tree));},IsSupersetOf:function(J){var K;K=this;return B.forall(function(L){return K.Contains(L);},J);},IsSubsetOf:function(J){return B.forall(function(K){return J.Contains(K);},this);},IsProperSupersetOf:function(J){return this.IsSupersetOf(J)&&this.Count()>J.Count();},IsProperSubsetOf:function(J){return this.IsSubsetOf(J)&&this.Count()<J.Count();},get_Tree:function(){return this.tree;},get_IsEmpty:function(){return this.tree==null;},Contains:function(J){return d.Contains(J,this.tree);},Add$1:function(J){return new k.New$1(d.Add(J,this.tree));},sub:function(J){return l.Filter(function(K){return!J.Contains(K);},this);},add:function(J){return new k.New$1(d.OfSeq(B.append(this,J)));},Remove:function(J){return F.FailWith("Set values cannot be mutated.");},CopyTo:function(J,K){z.ArrayCopyTo(A.ofSeq(this),J,K);},Clear:function(){F.FailWith("Set values cannot be mutated.");},Add:function(J){F.FailWith("Set values cannot be mutated.");},IsReadOnly:function(){return true;},CompareTo0:function(J){return B.compareWith(C.Compare,this,J);}},h,k);k.op_Subtraction=function(J,K){return l.Filter(function(L){return!K.Contains(L);},J);};k.op_Addition=function(J,K){return new k.New$1(d.OfSeq(B.append(J,K)));};k.New=E.Ctor(function(J){k.New$1.call(this,d.OfSeq(J));},k);k.New$1=E.Ctor(function(J){h.New.call(this);this.tree=J;},k);l.Partition=function(J,K){var L;L=A.partition(J,A.ofSeq(K));return[new k.New$1(d.OfSeq(L[0])),new k.New$1(d.OfSeq(L[1]))];};l.FoldBack=function(J,K,L){return B.fold(function(M,N){return J(N,M);},L,d.Enumerate(true,K.get_Tree()));};l.Filter=function(J,K){var L;return new k.New$1((L=A.ofSeq(B.filter(J,K)),d.Build(L,0,L.length-1)));};m=c.ListEnumerator=E.Class({get_Current:function(){return A.get(this.arr,this.i);},MoveNext$1:function(){this.i=this.i+1;return this.i<A.length(this.arr);},Dispose:a.ignore,Current:function(){return this.i===-1?F.FailWith("Enumeration has not started. Call MoveNext."):this.i>=A.length(this.arr)?F.FailWith("Enumeration already finished."):A.get(this.arr,this.i);},Current0:function(){return this.Current();},MoveNext:function(){return this.MoveNext$1();}},h,m);m.New=E.Ctor(function(J){h.New.call(this);this.arr=J;this.i=-1;},m);n.RemoveAll=function(J,K){var L,M,N,O;L=0;M=0;while(M<A.length(J))if(K(J[M])){N=M+1;while(N<A.length(J)&&K(J[N]))N=N+1;L=L+N-M;O=N-M;J.splice.apply(J,[M,O]);}else M=M+1;return L;};n.Remove=function(J,K){var L;L=A.findIndexBound(J,0,A.length(J),K==null?function(M){return M==null;}:function(M){var N;N=K;return C.Equals(N,M);});return L===-1?false:(J.splice.apply(J,[L,1]),true);};o=c.LinkedListEnumerator=E.Class({Dispose:a.ignore,MoveNext:function(){this.c=this.c.n;return!C.Equals(this.c,null);},Current0:function(){return this.Current();},Current:function(){return"c"in this.c?F.FailWith("Enumeration has not started. Call MoveNext."):this.c==null?F.FailWith("Enumeration already finished."):this.c.v;}},h,o);o.New=E.Ctor(function(J){h.New.call(this);this.c=J;},o);p=c.LinkedList=E.Class({GetEnumerator:function(){return new o.New(this);},CopyTo:function(J,K){var L,M;L=this.n;M=K;while(!C.Equals(L,null)){A.set(J,M,L.v);L=L.n;M=M+1;}},RemoveLast:function(){this.Remove$1(this.p);},RemoveFirst:function(){this.Remove$1(this.n);},Remove:function(J){var K;K=this.Find(J);return C.Equals(K,null)?false:(this.Remove$1(K),true);},Remove$1:function(J){var K,L;K=J.p;L=J.n;if(C.Equals(K,null))this.n=L;else K.n=L;if(C.Equals(L,null))this.p=K;else L.p=K;this.c=this.c-1;},FindLast:function(J){var K,L;K=this.p;L=true;while(L&&!C.Equals(K,null))if(K.v==J)L=false;else K=K.p;return L?null:K;},Find:function(J){var K,L;K=this.n;L=true;while(L&&!C.Equals(K,null))if(K.v==J)L=false;else K=K.n;return L?null:K;},Contains:function(J){var K,L;K=false;L=this.n;while(!C.Equals(L,null)&&!K)if(L.v==J)K=true;else L=L.n;return K;},Clear:function(){this.c=0;this.n=null;this.p=null;},AddLast:function(J){var K;return this.c===0?(K={p:null,n:null,v:J},(this.n=K,this.p=this.n,this.c=1,K)):this.AddAfter(this.p,J);},AddFirst:function(J){var K;return this.c===0?(K={p:null,n:null,v:J},(this.n=K,this.p=this.n,this.c=1,K)):this.AddBefore(this.n,J);},AddBefore:function(J,K){var L,M;L=J.p;M={p:L,n:J,v:K};if(C.Equals(J.p,null))this.n=M;J.p=M;if(!C.Equals(L,null))L.n=M;this.c=this.c+1;return M;},AddAfter:function(J,K){var L,M;L=J.n;M={p:J,n:L,v:K};if(C.Equals(J.n,null))this.p=M;J.n=M;if(!C.Equals(L,null))L.p=M;this.c=this.c+1;return M;},Add:function(J){this.AddLast(J);},Count:function(){return this.c;},IsReadOnly:function(){return false;}},h,p);p.New=E.Ctor(function(){p.New$1.call(this,[]);},p);p.New$1=E.Ctor(function(J){var K,L;h.New.call(this);this.c=0;this.n=null;this.p=null;K=z.Get(J);if(K.MoveNext()){this.n={p:null,n:null,v:K.Current()};this.p=this.n;this.c=1;}while(K.MoveNext()){L={p:this.p,n:null,v:K.Current()};this.p.n=L;this.p=L;this.c=this.c+1;}},p);q=b.Grouping=E.Class({System_Linq_IGrouping_2$get_Key:function(){return this.k;},GetEnumerator:function(){return z.Get(this.v);}},h,q);q.New=E.Ctor(function(J,K){h.New.call(this);this.k=J;this.v=K;},q);r=b.FsComparer=E.Class({Compare:function(J,K){return C.Compare(J,K);}},h,r);r.New=E.Ctor(function(){h.New.call(this);},r);s=b.ProjectionComparer=E.Class({Compare:function(J,K){return this.primary.Compare(this.projection(J),this.projection(K));}},h,s);s.New=E.Ctor(function(J,K){h.New.call(this);this.primary=J;this.projection=K;},s);t=b.CompoundComparer=E.Class({Compare:function(J,K){var L;L=this.primary.Compare(J,K);return L===0?this.secondary.Compare(J,K):L;}},h,t);t.New=E.Ctor(function(J,K){h.New.call(this);this.primary=J;this.secondary=K;},t);u=b.ReverseComparer=E.Class({Compare:function(J,K){return this.primary.Compare(this.projection(K),this.projection(J));}},h,u);u.New=E.Ctor(function(J,K){h.New.call(this);this.primary=J;this.projection=K;},u);v=b.OrderedEnumerable=E.Class({GetEnumerator:function(){var J,K;J=this;K=A.ofSeq(this.source);A.sortInPlaceWith(function(L,M){return J.primary.Compare(L,M);},K);return z.Get(K);},System_Linq_IOrderedEnumerable_1$CreateOrderedEnumerable:function(J,K,L){return new v.New(this.source,new t.New(this.primary,L?new u.New(K,J):new s.New(K,J)));}},h,v);v.New=E.Ctor(function(J,K){h.New.call(this);this.source=J;this.primary=K;},v);w.ElementAtOrDefault=function(J,K,L){try{return B.nth(K,J);}catch(M){return L;}};w.FirstOrDefault=function(J,K){var L;L=z.Get(J);try{return L.MoveNext()?L.Current():K;}finally{if(typeof L=="object"&&"Dispose"in L)L.Dispose();}};w.FirstOrDefault$1=function(J,K,L){var M;M=B.tryFind(K,J);return M==null?L:M.$0;};w.LastOrDefault=function(J,K,L){var M;M=w.LastPred(J,K);return M==null?L:M.$0;};w.SingleOrDefault=function(J,K,L){var M,N;M=z.Get(J);try{N=null;while(M.MoveNext())if(K(M.Current()))if(N!=null&&N.$==1)F.InvalidOp("Sequence contains more than one element");else N={$:1,$0:M.Current()};return N==null?L:N.$0;}finally{if(typeof M=="object"&&"Dispose"in M)M.Dispose();}};w.Where=function(J,K){return B.delay(function(){return B.enumUsing(z.Get(J),function(L){var M;M=0;return B.enumWhile(function(){return L.MoveNext();},B.delay(function(){return B.append(K(L.Current(),M)?[L.Current()]:[],B.delay(function(){M=M+1;return[];}));}));});});};w.Union=function(J,K,L){var M,N;M=new G.New(J,L);N=z.Get(K);try{while(N.MoveNext())M.SAdd(N.Current());}finally{if(typeof N=="object"&&"Dispose"in N)N.Dispose();}return M;};w.ToDictionary=function(J,K,L,M){var N;N=new y.New$3(M);B.iter(function(O){N.DAdd(K(O),L(O));},J);return N;};w.ToDictionary$1=function(J,K,L){var M;M=new y.New$3(L);B.iter(function(N){M.DAdd(K(N),N);},J);return M;};w.TakeWhile=function(J,K){return B.delay(function(){return B.enumUsing(z.Get(J),function(L){return B.enumWhile(function(){return L.MoveNext()&&K(L.Current());},B.delay(function(){return[L.Current()];}));});});};w.TakeWhile$1=function(J,K){return B.delay(function(){return B.enumUsing(z.Get(J),function(L){var M;M=0;return B.enumWhile(function(){return L.MoveNext()&&K(L.Current(),M);},B.delay(function(){M=M+1;return[L.Current()];}));});});};w.Take=function(J,K){return B.delay(function(){return B.enumUsing(z.Get(J),function(L){var M;M=0;return B.enumWhile(function(){return M<K&&L.MoveNext();},B.delay(function(){M=M+1;return[L.Current()];}));});});};w.Sum=function(J){var K;K=B.choose(function(L){return L!=null?{$:1,$0:H.get(L)}:null;},J);return B.isEmpty(K)?null:B.sum(K);};w.SkipWhile=function(J,K){return B.delay(function(){return B.enumUsing(z.Get(J),function(L){var M;M=true;return B.append(B.enumWhile(function(){return M&&L.MoveNext();},B.delay(function(){return!K(L.Current())?(M=false,[]):[];})),B.delay(function(){return!M?B.append([L.Current()],B.delay(function(){return B.enumWhile(function(){return L.MoveNext();},B.delay(function(){return[L.Current()];}));})):[];}));});});};w.SkipWhile$1=function(J,K){return B.delay(function(){return B.enumUsing(z.Get(J),function(L){var M,N;M=0;N=true;return B.append(B.enumWhile(function(){return N&&L.MoveNext();},B.delay(function(){return K(L.Current(),M)?(M=M+1,[]):(N=false,[]);})),B.delay(function(){return!N?B.append([L.Current()],B.delay(function(){return B.enumWhile(function(){return L.MoveNext();},B.delay(function(){return[L.Current()];}));})):[];}));});});};w.Skip=function(J,K){return B.delay(function(){return B.enumUsing(z.Get(J),function(L){var M;M=0;return B.append(B.enumWhile(function(){return M<K&&L.MoveNext();},B.delay(function(){M=M+1;return[];})),B.delay(function(){return B.enumWhile(function(){return L.MoveNext();},B.delay(function(){return[L.Current()];}));}));});});};w.Single=function(J,K){var L;function M(N,O){return K(O)?N!=null?F.InvalidOp("Sequence contains more than one matching element"):{$:1,$0:O}:N;}L=(((E.Curried3(B.fold))(M))(null))(J);return L!=null&&L.$==1?L.$0:F.InvalidOp("Sequence contains no elements");};w.SequenceEqual=function(J,K,L){var M,N,O;M=z.Get(J);function P(){while(true)if(M.MoveNext()){if(!(O.MoveNext()&&L.CEquals(M.Current(),O.Current())))return false;}else return!O.MoveNext();}try{O=z.Get(J);try{N=P();}finally{if(typeof O=="object"&&"Dispose"in O)O.Dispose();}return N;}finally{if(typeof M=="object"&&"Dispose"in M)M.Dispose();}};w.SelectMany=function(J,K,L){function M(N,O){return B.map(function(P){return L(N,P);},O);}return B.collect(function(N){return M(N[0],N[1]);},B.mapi(function(N,O){return[O,K(O,N)];},J));};w.SelectMany$1=function(J,K,L){function M(N,O){return B.map(function(P){return L(N,P);},O);}return B.collect(function(N){return M(N[0],N[1]);},B.map(function(N){return[N,K(N)];},J));};w.SelectMany$2=function(J,K){return B.concat(B.mapi(function(L,M){return K(M,L);},J));};w.Select=function(J,K){return B.mapi(function(L,M){return K(M,L);},J);};w.Reverse=function(J){return A.ofSeq(J).slice().reverse();};w.Repeat=function(J,K){return B.init(K,function(){return J;});};w.Range=function(J,K){return B.init(K,function(L){return J+L;});};w.OrderByDescending=function(J,K,L){return new v.New(J,new u.New(L,K));};w.OrderBy=function(J,K,L){return new v.New(J,new s.New(L,K));};w.Min=function(J){var K;K=B.choose(function(L){return L!=null?{$:1,$0:H.get(L)}:null;},J);return B.isEmpty(K)?null:B.min(K);};w.Max=function(J){var K;K=B.choose(function(L){return L!=null?{$:1,$0:H.get(L)}:null;},J);return B.isEmpty(K)?null:B.max(K);};w.Last=function(J,K){var L;L=w.LastPred(J,K);return L==null?F.InvalidOp("Sequence contains no matching element"):L.$0;};w.LastPred=function(J,K){function L(M,N){return K(N)?{$:1,$0:N}:M;}return(((E.Curried3(B.fold))(L))(null))(J);};w.Join=function(J,K,L,M,N,O){return B.delay(function(){var P,Q,R;P=new y.New$3(O);Q=A.ofSeq(B.delay(function(){return B.collect(function(S){var T,U,V;T=L(S);return(U=null,[P.TryGetValue(T,{get:function(){return U;},set:function(W){U=W;}}),U])[0]?[]:(V=[S,E.MarkResizable([])],(P.DAdd(T,V),[V]));},J);}));R=z.Get(K);try{while(R.MoveNext())(function(){var S,T,U;S=R.Current();T=(U=null,[P.TryGetValue(M(S),{get:function(){return U;},set:function(V){U=V;}}),U]);return T[0]?void T[1][1].push(S):null;}());}finally{if(typeof R=="object"&&"Dispose"in R)R.Dispose();}return A.ofSeq(B.delay(function(){return B.collect(function(S){var T;T=S[0];return B.map(function(U){return N(T,U);},S[1]);},Q);}));});};w.Intersect=function(J,K,L){var M;M=new G.New(J,L);return B.delay(function(){var N;N=new G.New$1(L);return B.collect(function(O){return M.Contains(O)&&N.SAdd(O)?[O]:[];},K);});};w.GroupJoin=function(J,K,L,M,N,O){return B.delay(function(){var P,Q,R;P=new y.New$3(O);Q=A.ofSeq(B.delay(function(){return B.collect(function(S){var T,U,V;T=L(S);return(U=null,[P.TryGetValue(T,{get:function(){return U;},set:function(W){U=W;}}),U])[0]?[]:(V=[S,E.MarkResizable([])],(P.DAdd(T,V),[V]));},J);}));R=z.Get(K);try{while(R.MoveNext())(function(){var S,T,U;S=R.Current();T=(U=null,[P.TryGetValue(M(S),{get:function(){return U;},set:function(V){U=V;}}),U]);return T[0]?void T[1][1].push(S):null;}());}finally{if(typeof R=="object"&&"Dispose"in R)R.Dispose();}A.iteri(function(S,T){return A.set(Q,S,N(T[0],T[1]));},Q);return Q;});};w.GroupBy=function(J,K,L,M,N){return B.map(function(O){return M(O.System_Linq_IGrouping_2$get_Key(),O);},w.GroupBy$1(J,K,L,N));};w.GroupBy$1=function(J,K,L,M){return B.delay(function(){return A.ofSeq(B.delay(function(){var N;N=new y.New$3(M);return B.collect(function(O){var P,Q,R,S,T;P=K(O);Q=L(O);R=(S=null,[N.TryGetValue(P,{get:function(){return S;},set:function(U){S=U;}}),S]);return R[0]?(R[1].push(Q),[]):(T=E.MarkResizable([]),(T.push(Q),N.set_Item(P,T),[new q.New(P,T)]));},J);}));});};w.Except=function(J,K,L){var M,N;M=new G.New(J,L);N=z.Get(K);try{while(N.MoveNext())M.Remove(N.Current());}finally{if(typeof N=="object"&&"Dispose"in N)N.Dispose();}return M;};w.Distinct=function(J,K){return B.delay(function(){return B.enumUsing(z.Get(J),function(L){var M;M=new G.New$1(K);return B.enumWhile(function(){return L.MoveNext();},B.delay(function(){return M.SAdd(L.Current())?[L.Current()]:[];}));});});};w.DefaultIfEmpty=function(J,K){return B.isEmpty(J)?[K]:J;};w.Average=function(J){var K,L,M,N;K=[];L=z.Get(J);try{while(L.MoveNext()){if(M=L.Current(),M!=null){K.push((N=L.Current(),H.get(N)));}}return A.length(K)===0?null:B.sum(K)/A.length(K);}finally{if(typeof L=="object"&&"Dispose"in L)L.Dispose();}};x=b.Query=E.Class({},h,x);x.averageByNullable=function(J,K){var L;L=A.ofSeq(B.choose(function(M){return I.ofNullable(K(M));},J));return A.length(L)===0?null:A.average(L);};x.sumByNullable=function(J,K){return A.sum(A.ofSeq(B.choose(function(L){return I.ofNullable(K(L));},J)));};x.CheckThenBySource=function(J){return typeof J=="object"&&"System_Linq_IOrderedEnumerable_1$CreateOrderedEnumerable"in J?J:F.FailWith("'thenBy' and 'thenByDescending' may only be used with an ordered input");};x.New=E.Ctor(function(){h.New.call(this);},x);}(self));
