(function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K;b=a.WebSharper=a.WebSharper||{};c=b.Sitelets=b.Sitelets||{};d=c.CorsAllows=c.CorsAllows||{};e=c.StringEncoding=c.StringEncoding||{};f=c.PathUtil=c.PathUtil||{};g=c.Route=c.Route||{};h=c.List=c.List||{};i=c.Router=c.Router||{};j=a.Error;k=c.RouterModule=c.RouterModule||{};l=k.BodyTextNeededForRoute=k.BodyTextNeededForRoute||{};m=b&&b.Obj;n=k.ListArrayConverter=k.ListArrayConverter||{};o=c.RouterOperators=c.RouterOperators||{};p=a.StartupCode$WebSharper_Sitelets$Router=a.StartupCode$WebSharper_Sitelets$Router||{};q=b&&b.Strings;r=a.String;s=b&&b.Runtime;t=b&&b.List;u=b&&b.Seq;v=b&&b.Collections;w=v&&v.Map;x=b&&b.Arrays;y=v&&v.FSharpMap;z=b&&b.Unchecked;A=b&&b.Utils;B=a.console;C=b&&b.Nullable;D=b&&b.Numeric;E=b&&b.Lazy;F=b&&b.Operators;G=b&&b.Concurrency;H=b&&b.Char;I=a.System;J=I&&I.Guid;K=b&&b.Slice;d.New=function(L,M,N,O,P,Q){return{Origins:L,Methods:M,Headers:N,ExposeHeaders:O,MaxAge:P,Credentials:Q};};e.read=function(L){var M;function N(O){var P;while(true){P=e.readEscapedFromChars(O);if(P[0]===-2)return null;else if(P[0]===-1)return{$:1,$0:(function(Q){return function(R){return q.concat(Q,R);};}(""))(M)};else{M.push(r.fromCharCode(P[0]));O=P[1];}}}M=s.MarkResizable([]);return N(t.ofSeq(u.map(function(O){return O.charCodeAt();},L)));};e.readEscapedFromChars=function(L){var M,N,O,P,Q,R,S,T;function U(){var W,X;return M.$==1?(W=M.$1,(X=M.$0,(M=W,X))):-1;}function V(W){return W>="0".charCodeAt()&&W<="9".charCodeAt()?W-"0".charCodeAt():W>="a".charCodeAt()&&W<="f".charCodeAt()?W-"a".charCodeAt()+10:W>="A".charCodeAt()&&W<="F".charCodeAt()?W-"A".charCodeAt()+10:-2;}M=L;return[(N=U(),N==="~".charCodeAt()?(O=U(),O==="u".charCodeAt()?(P=U(),(Q=U(),(R=U(),(S=U(),P>=0&&Q>=0&&R>=0&&S>=0?e.op_PlusPlus(e.op_PlusPlus(e.op_PlusPlus(V(P),V(Q)),V(R)),V(S)):-2)))):(T=U(),O>=0&&T>=0?e.op_PlusPlus(V(O),V(T)):-2)):N),M];};e.op_PlusPlus=function(L,M){return(L<<4)+M;};e.write=function(L){return q.concat("",u.mapi(function(M,N){return e.writeEscapedAsString(M+1===L.length,N);},L));};e.writeEscapedAsString=function(L,M){var N;N=M.charCodeAt();return e.isUnreserved(L,M)?M:N<256?"~"+q.PadLeftWith(N.toString(16),2,"0"):"~u"+q.PadLeftWith(N.toString(16),4,"0");};e.isUnreserved=function(L,M){return M==="-"||(M==="."?!L:M==="_"||(M>="A"&&M<="Z"||(M>="a"&&M<="z"||M>="0"&&M<="9")));};f.WriteLink=function(L,M){var N;N=M.get_IsEmpty()?"":"?"+f.WriteQuery(M);return"/"+f.Concat(L)+N;};f.WriteQuery=function(L){function M(N,O){return N+"="+O;}return q.concat("&",u.map(function(N){return M(N[0],N[1]);},w.ToSeq(L)));};f.Concat=function(L){var M,N;M=[];N=true;t.iter(function(O){if(!q.IsNullOrEmpty(O)){N?N=false:M.push("/");M.push(O);}},L);return q.Join("",x.ofSeq(M));};g=c.Route=s.Class({ToLink:function(){return f.WriteLink(this.Segments,this.QueryArgs);}},null,g);g.FromHash=function(L,M){var N,O;N=L.indexOf("#");return N===-1?g.get_Empty():(O=L.substring(N+1),M!=null&&M.$0?O===""||O==="/"?g.get_Empty():q.StartsWith(O,"/")?g.FromUrl(O.substring(1),{$:1,$0:true}):g.Segment$2(O):g.FromUrl(L.substring(N),{$:1,$0:false}));};g.FromUrl=function(L,M){var N,O,P;N=(O=L.indexOf("?"),O===-1?[L,new y.New([])]:[q.Substring(L,0,O),g.ParseQuery(L.substring(O+1))]);P=g.get_Empty();return g.New(t.ofArray(q.SplitChars(N[0],["/"],M!=null&&M.$0?0:1)),N[1],P.FormData,P.Method,P.Body);};g.WriteQuery=function(L){return f.WriteQuery(L);};g.ParseQuery=function(L){return w.OfArray(x.ofSeq(x.choose(function(M){var N,O;N=q.SplitChars(M,["="],0);return!z.Equals(N,null)&&N.length===2?(O=x.get(N,1),{$:1,$0:[x.get(N,0),O]}):((function(P){return function(Q){return P("wrong format for query argument: "+A.toSafe(Q));};}(function(P){B.log(P);}))(M),null);},q.SplitChars(L,["&"],0))));};g.Combine=function(L){var M,N,O,P,Q,R,S;M=x.ofSeq(L);N=x.length(M);return N===0?g.get_Empty():N===1?x.get(M,0):(O=null,P=null,Q=[],R=new y.New([]),S=new y.New([]),x.iter(function(T){var U,V;U=T.Method;if(U!=null&&U.$==1)O=U;V=T.Body;if(V==null);else P=V;R=w.FoldBack(function(W,X,Y){return Y.Add$1(W,X);},R,T.QueryArgs);S=w.FoldBack(function(W,X,Y){return Y.Add$1(W,X);},S,T.FormData);t.iter(function(W){Q.push(W);},T.Segments);},M),g.New(t.ofSeq(Q),R,S,O,P));};g.Segment=function(L,M){var N;N=g.get_Empty();return g.New(L,N.QueryArgs,N.FormData,M,N.Body);};g.Segment$1=function(L){var M;M=g.get_Empty();return g.New(L,M.QueryArgs,M.FormData,M.Method,M.Body);};g.Segment$2=function(L){var M;M=g.get_Empty();return g.New(t.ofArray([L]),M.QueryArgs,M.FormData,M.Method,M.Body);};g.get_Empty=function(){return g.New(t.T.Empty,new y.New([]),new y.New([]),null,{$:1,$0:null});};g.New=function(L,M,N,O,P){return new g({Segments:L,QueryArgs:M,FormData:N,Method:O,Body:P});};h.startsWith=function(L,M){var N;switch(L.$==1?M.$==1?z.Equals(L.$0,M.$0)?(N=[M.$0,M.$1,L.$0,L.$1],1):2:2:0){case 0:return{$:1,$0:M};case 1:return h.startsWith(N[3],N[1]);case 2:return null;}};i.op_Addition=function(L,M){return i.New(function(N){return u.append(L.Parse(N),M.Parse(N));},L.Segment);};i.op_Division=function(L,M){return i.New(function(N){return u.collect(M.Parse,L.Parse(N));},u.append(L.Segment,M.Segment));};i.FromString=function(L){var M,N;M=q.SplitChars(L,["/"],1);return M.length==0?i.New(function(O){return[O];},[]):(N=t.ofArray(M),i.New(function(O){var P;P=h.startsWith(N,O.Segments);return P!=null&&P.$==1?[g.New(P.$0,O.QueryArgs,O.FormData,O.Method,O.Body)]:[];},[g.Segment$1(N)]));};i.New=function(L,M){return{Parse:L,Segment:M};};i.op_Addition$1=function(L,M){return i.New$1(function(N){return u.append(L.Parse(N),M.Parse(N));},function(N){var O;O=L.Write(N);return O==null?M.Write(N):O;});};i.op_Division$1=function(L,M){return i.New$1(function(N){function O(P,Q){return u.map(function(R){return[R,Q];},M.Parse(P));}return u.collect(function(P){return O(P[0],P[1]);},L.Parse(N));},function(N){var O;O=L.Write(N);return O==null?null:{$:1,$0:u.append(O.$0,M.Segment)};});};i.op_Division$2=function(L,M){return i.New$1(function(N){return u.collect(M.Parse,L.Parse(N));},function(N){var O;O=M.Write(N);return O==null?null:{$:1,$0:u.append(L.Segment,O.$0)};});};i.op_Division$3=function(L,M){return i.New$1(function(N){function O(P,Q){function R(S,T){return[S,[Q,T]];}return u.map(function(S){return R(S[0],S[1]);},M.Parse(P));}return u.collect(function(P){return O(P[0],P[1]);},L.Parse(N));},function(N){var O,P,Q;O=L.Write(N[0]);P=M.Write(N[1]);return O!=null&&O.$==1&&(P!=null&&P.$==1&&(Q=[O.$0,P.$0],true))?{$:1,$0:u.append(Q[0],Q[1])}:null;});};i.New$1=function(L,M){return{Parse:L,Write:M};};l=k.BodyTextNeededForRoute=s.Class({},j,l);l.New=s.Ctor(function(){this.message="This router needs body text loaded synchronously. Wait for Http.Request.BodyText to finish then try again.";a.Object.setPrototypeOf(this,l.prototype);},l);n=k.ListArrayConverter=s.Class({WebSharper_Sitelets_RouterModule_IListArrayConverter$ToArray:function(L){return x.ofList(L);},WebSharper_Sitelets_RouterModule_IListArrayConverter$OfArray:function(L){return t.ofArray(L);}},m,n);n.New=s.Ctor(function(){m.New.call(this);},n);k.Cast=function(L,M,N){return i.New$1(function(O){function P(Q,R){var S;S=L(R);return S!=null&&S.$==1?{$:1,$0:[Q,S.$0]}:null;}return u.choose(function(Q){return P(Q[0],Q[1]);},N.Parse(O));},function(O){var P;P=M(O);return P==null?null:N.Write(P.$0);});};k.Unbox=function(L,M){return i.New$1(function(N){function O(P,Q){var R;R=L(Q);return R!=null&&R.$==1?{$:1,$0:[P,R.$0]}:null;}return u.choose(function(P){return O(P[0],P[1]);},M.Parse(N));},M.Write);};k.Box=function(L,M){return i.New$1(function(N){function O(P,Q){return[P,Q];}return u.map(function(P){return O(P[0],P[1]);},M.Parse(N));},function(N){var O;O=L(N);return O==null?null:M.Write(O.$0);});};k.List=function(L){return k.Map(t.ofArray,x.ofList,k.Array(L));};k.Option=function(L){return i.New$1(function(M){var N,O;O=M.Segments;function P(Q,R){return[Q,{$:1,$0:R}];}switch(O.$==1?O.$0==="None"?(N=O.$1,0):O.$0==="Some"?(N=O.$1,1):2:2){case 0:return[[g.New(N,M.QueryArgs,M.FormData,M.Method,M.Body),null]];case 1:return u.map(function(Q){return P(Q[0],Q[1]);},L.Parse(g.New(N,M.QueryArgs,M.FormData,M.Method,M.Body)));case 2:return[];}},function(M){var N,O,P;return M!=null&&M.$==1?(N=L.Write(M.$0),(O=(P=[g.Segment$2("Some")],function(Q){return u.append(P,Q);}),N==null?null:{$:1,$0:O(N.$0)})):{$:1,$0:[g.Segment$2("None")]};});};k.Nullable=function(L){return i.New$1(function(M){var N,O;function P(Q,R){return[Q,R];}N=M.Segments;return N.$==1&&(N.$0==="null"&&(O=N.$1,true))?[[g.New(O,M.QueryArgs,M.FormData,M.Method,M.Body),null]]:u.map(function(Q){return P(Q[0],Q[1]);},L.Parse(M));},function(M){return M!=null?L.Write(C.get(M)):{$:1,$0:[g.Segment$2("null")]};});};k.Array=function(L){return i.New$1(function(M){var N,O,P;function Q(R){return function(S){return function(T){function U(V,W){return((Q(R-1))(V))(new t.T({$:1,$0:W,$1:T}));}return R===0?[[S,x.ofList(t.rev(T))]]:u.collect(function(V){return U(V[0],V[1]);},L.Parse(S));};};}N=M.Segments;return N.$==1?(O=(P=0,[D.TryParseInt32(N.$0,{get:function(){return P;},set:function(R){P=R;}}),P]),O[0]?((Q(O[1]))(g.New(N.$1,M.QueryArgs,M.FormData,M.Method,M.Body)))(t.T.Empty):[]):[];},function(M){var N;N=x.map(L.Write,M);return x.forall(function(O){return O!=null;},N)?{$:1,$0:u.append([g.Segment$2(r(x.length(M)))],u.collect(function(O){return O.$0;},N))}:null;});};k.Delay=function(L){var M;M=E.Create(L);return i.New$1(function(N){return M.f().Parse(N);},function(N){return M.f().Write(N);});};k.Single=function(L,M){var N,O;N=q.SplitChars(M,["/"],1);return N.length==0?i.New$1(function(P){return[[P,L]];},function(P){return z.Equals(P,L)?{$:1,$0:[]}:null;}):(O=t.ofArray(N),i.New$1(function(P){var Q;Q=h.startsWith(O,P.Segments);return Q!=null&&Q.$==1?[[g.New(Q.$0,P.QueryArgs,P.FormData,P.Method,P.Body),L]]:[];},function(P){return z.Equals(P,L)?{$:1,$0:[g.Segment$1(O)]}:null;}));};k.Table=function(L){function M(N,O){return k.MapTo(N,i.FromString(O));}return k.Sum(u.map(function(N){return M(N[0],N[1]);},L));};k.Sum=function(L){var M;M=x.ofSeq(L);return i.New$1(function(N){return u.collect(function(O){return O.Parse(N);},M);},function(N){return u.tryPick(function(O){return O.Write(N);},M);});};k.MapTo=function(L,M){return i.New$1(function(N){return u.map(function(O){return[O,L];},M.Parse(N));},function(N){return z.Equals(N,L)?{$:1,$0:M.Segment}:null;});};k.Filter=function(L,M){return i.New$1(function(N){function O(P){return P[1];}return u.filter(function(P){return L(O(P));},M.Parse(N));},function(N){return L(N)?M.Write(N):null;});};k.TryMap=function(L,M,N){return i.New$1(function(O){function P(Q,R){var S;S=L(R);return S==null?null:{$:1,$0:[Q,S.$0]};}return u.choose(function(Q){return P(Q[0],Q[1]);},N.Parse(O));},function(O){var P;P=M(O);return P==null?null:N.Write(P.$0);});};k.Map=function(L,M,N){return i.New$1(function(O){function P(Q,R){return[Q,L(R)];}return u.map(function(Q){return P(Q[0],Q[1]);},N.Parse(O));},function(O){return N.Write(M(O));});};k.Embed=function(L,M,N){return i.New$1(function(O){function P(Q,R){return[Q,L(R)];}return u.map(function(Q){return P(Q[0],Q[1]);},N.Parse(O));},function(O){var P;P=M(O);return P==null?null:N.Write(P.$0);});};k.Slice=function(L,M,N){return i.New$1(function(O){function P(Q,R){var S;S=L(R);return S==null?null:{$:1,$0:[Q,S.$0]};}return u.choose(function(Q){return P(Q[0],Q[1]);},N.Parse(O));},function(O){return N.Write(M(O));});};k.HashLink=function(L,M){return"#"+k.Link(L,M);};k.Fetch=function(L,M){return k.FetchWith(null,{},L,M);};k.FetchWith=function(L,M,N,O){var P,Q,R,S,T,U,V;P=M?M:{};Q=k.Write(N,O);return Q!=null&&Q.$==1?(R=Q.$0,(P.method=(S=R.Method,S==null?"POST":S.$0),T=R.Body.$0,T===null?!R.FormData.get_IsEmpty()?(U=new a.FormData(),w.Iterate(function(W,X){return U.append(W,X);},R.FormData),P.body=U):void 0:P.body=T,V=R.ToLink(),self.fetch(L==null?V:q.TrimEnd(L.$0,["/"])+V,P))):F.FailWith("Failed to map endpoint to request");};k.XHR=function(L,M){return k.XHRWith({ResponseT:"text",Url:"",IsAsync:true,Username:"",Password:"",Timeout:0,WithCredentials:false},L,M);};k.XHRWith=function(L,M,N){var O,P,Q,R,S;O=new a.XMLHttpRequest();P=k.Write(M,N);return P!=null&&P.$==1?(Q=P.$0,(L.ResponseT===void 0?L.ResponseT="text":void 0,R=(S=Q.Method,S==null?"POST":S.$0),G.FromContinuations(function(T,U){var V,W,X;O.onload=function(){return T(O.response);};O.onerror=function(){return U(new j(O.statusText));};V=Q.ToLink();L.Url=L.Url?q.TrimEnd(L.Url,["/"])+V:V;if(L.Username!==""&&L.Password!=="")O.open(R,L.Url,L.IsAsync,L.Username,L.Password);else O.open(R,L.Url,L.IsAsync);if(L.Timeout!==0)O.timeout=L.Timeout;if(L.WithCredentials)O.withCredentials=L.WithCredentials;W=Q.Body.$0;return W===null?!Q.FormData.get_IsEmpty()?(X=new a.FormData(),(w.Iterate(function(Y,Z){return X.append(Y,Z);},Q.FormData),O.send(X))):O.send():O.send(W);}))):F.FailWith("Failed to map endpoint to request");};k.Link=function(L,M){var N;N=k.Write(L,M);return N==null?"":N.$0.ToLink();};k.TryLink=function(L,M){var N;N=k.Write(L,M);return N==null?null:{$:1,$0:N.$0.ToLink()};};k.Write=function(L,M){var N;N=L.Write(M);return N==null?null:{$:1,$0:g.Combine(N.$0)};};k.Parse=function(L,M){function N(O,P){return O.Segments.$==0?{$:1,$0:P}:null;}return u.tryPick(function(O){return N(O[0],O[1]);},L.Parse(M));};k.FormData=function(L){return i.New$1(function(M){function N(O,P){return[M,P];}return u.map(function(O){return N(O[0],O[1]);},L.Parse(g.New(M.Segments,M.FormData,M.FormData,M.Method,M.Body)));},function(M){var N;N=L.Write(M);return N==null?null:{$:1,$0:u.map(function(O){return g.New(O.Segments,new y.New([]),O.QueryArgs,O.Method,O.Body);},N.$0)};});};k.Body=function(L,M){return i.New$1(function(N){var O,P;P=N.Body;if(P!=null&&P.$==1)return P.$0===null?[]:(O=L(P.$0),O!=null&&O.$==1?[[g.New(N.Segments,N.QueryArgs,N.FormData,N.Method,{$:1,$0:null}),O.$0]]:[]);else throw new l.New();},function(N){var O;return{$:1,$0:[(O=g.get_Empty(),g.New(O.Segments,O.QueryArgs,O.FormData,O.Method,{$:1,$0:M(N)}))]};});};k.Method=function(L){var M;return i.New(function(N){var O,P;O=N.Method;return O!=null&&O.$==1&&(O.$0===L&&(P=O.$0,true))?[N]:[];},[(M=g.get_Empty(),g.New(M.Segments,M.QueryArgs,M.FormData,{$:1,$0:L},M.Body))]);};k.QueryNullable=function(L,M){return i.New$1(function(N){var O,P,Q;function R(S,T){return[g.New(N.Segments,P,N.FormData,N.Method,N.Body),T];}O=N.QueryArgs.TryFind(L);return O!=null&&O.$==1?(P=N.QueryArgs.Remove$1(L),u.map(function(S){return R(S[0],S[1]);},M.Parse((Q=g.get_Empty(),g.New(t.ofArray([O.$0]),Q.QueryArgs,Q.FormData,Q.Method,Q.Body))))):[[N,null]];},function(N){var O,P,Q,R;return N!=null?(O=M.Write(C.get(N)),O==null?null:{$:1,$0:(P=g.Combine(O.$0).Segments,P.$==1&&(P.$1.$==0&&(Q=P.$0,true))?[(R=g.get_Empty(),g.New(R.Segments,w.OfArray(x.ofSeq(t.ofArray([[L,Q]]))),R.FormData,R.Method,R.Body))]:[])}):{$:1,$0:[]};});};k.QueryOption=function(L,M){return i.New$1(function(N){var O,P,Q;function R(S,T){return[g.New(N.Segments,P,N.FormData,N.Method,N.Body),{$:1,$0:T}];}O=N.QueryArgs.TryFind(L);return O!=null&&O.$==1?(P=N.QueryArgs.Remove$1(L),u.map(function(S){return R(S[0],S[1]);},M.Parse((Q=g.get_Empty(),g.New(t.ofArray([O.$0]),Q.QueryArgs,Q.FormData,Q.Method,Q.Body))))):[[N,null]];},function(N){var O,P,Q,R;return N!=null&&N.$==1?(O=M.Write(N.$0),O==null?null:{$:1,$0:(P=g.Combine(O.$0).Segments,P.$==1&&(P.$1.$==0&&(Q=P.$0,true))?[(R=g.get_Empty(),g.New(R.Segments,w.OfArray(x.ofSeq(t.ofArray([[L,Q]]))),R.FormData,R.Method,R.Body))]:[])}):{$:1,$0:[]};});};k.Query=function(L,M){return i.New$1(function(N){var O,P,Q;function R(S,T){return[g.New(N.Segments,P,N.FormData,N.Method,N.Body),T];}O=N.QueryArgs.TryFind(L);return O!=null&&O.$==1?(P=N.QueryArgs.Remove$1(L),u.map(function(S){return R(S[0],S[1]);},M.Parse((Q=g.get_Empty(),g.New(t.ofArray([O.$0]),Q.QueryArgs,Q.FormData,Q.Method,Q.Body))))):[];},function(N){var O,P,Q,R;O=M.Write(N);return O==null?null:{$:1,$0:(P=g.Combine(O.$0).Segments,P.$==1&&(P.$1.$==0&&(Q=P.$0,true))?[(R=g.get_Empty(),g.New(R.Segments,w.OfArray(x.ofSeq(t.ofArray([[L,Q]]))),R.FormData,R.Method,R.Body))]:[])};});};k.CreateWithQuery=function(L,M){return i.New$1(function(N){var O;O=M(N.Segments,N.QueryArgs);return O==null?[]:[[g.New(t.T.Empty,N.QueryArgs,N.FormData,N.Method,N.Body),O.$0]];},function(N){var O,P;O=L(N);return{$:1,$0:[(P=g.get_Empty(),g.New(O[0],O[1],P.FormData,P.Method,P.Body))]};});};k.Create=function(L,M){return i.New$1(function(N){var O;O=M(N.Segments);return O==null?[]:[[g.New(t.T.Empty,N.QueryArgs,N.FormData,N.Method,N.Body),O.$0]];},function(N){return{$:1,$0:[g.Segment$1(L(N))]};});};k.New=function(L,M){var N;N={WebSharper_Sitelets_IRouter_1$Route:L,WebSharper_Sitelets_IRouter_1$Link:M};m.New.call(N);return N;};k.Empty=function(){p.$cctor();return p.Empty;};o.JSClass=function(L,M,N,O){var P,Q;function R(U){function V(W,X,Y){var Z;return X?(Z=U[W],z.Equals(Z,void 0)?null:{$:1,$0:Z}):U[W];}return x.map(function(W){return V(W[0],W[1],W[2]);},M);}function S(U){var V;function W(X,Y,Z){return function(_0){if(Y){if(_0!=null&&_0.$==1)V[X]=_0.$0;}else V[X]=_0;};}V=L();(((s.Curried3(x.iter2))(function(X,Y){return(function(Z){return W(Z[0],Z[1],Z[2]);}(X))(Y);}))(M))(U);return V;}function T(U,V){return[U,t.ofSeq(u.map(function(W){return typeof W=="number"?{$:1,$0:[W,(x.get(M,W))[2]]}:{$:0,$0:W};},V))];}P=x.map(function(U){return T(U[0],U[1]);},N);Q=i.New$1(function(U){function V(X,Y,Z){var _0,_1,_2,_3,_4,_5,_6,_7;while(true){if(X.$==1){if(X.$0.$==1){_0=X.$0.$0[1];_1=X.$0.$0[0];_2=X.$1;_3=_0.Parse(Y);return(function(_8){return function(_9){return u.collect(_8,_9);};}(function(_8,_9,_){return function($){var ba;ba=_8.slice();x.set(ba,_9,$[1]);return V(_,$[0],ba);};}(Z,_1,_2)))(_3);}else{_5=X.$0.$0;_6=X.$1;_7=Y.Segments;if(_7.$==1&&(_7.$0===_5&&(_4=[_7.$0,_7.$1],true))){X=_6;Y=g.New(_4[1],Y.QueryArgs,Y.FormData,Y.Method,Y.Body);}else return[];}}else return[[Y,S(Z)]];}}function W(X,Y){return o.isCorrectMethod(X,U.Method)?V(Y,U,x.create(x.length(M),null)):[];}return u.collect(function(X){return W(X[0],X[1]);},P);},function(U){var V,W,X,Y,Z,_0;V=R(U);W=x.get(N,0);X=W[0];Y=x.map(function(_1){return typeof _1=="number"?(x.get(M,_1))[2].Write(x.get(V,_1)):{$:1,$0:[g.Segment$2(_1)]};},W[1]);return x.forall(function(_1){return _1!=null;},Y)?(Z=u.collect(function(_1){return _1.$0;},Y),X==null?{$:1,$0:Z}:{$:1,$0:u.append([(_0=g.get_Empty(),g.New(_0.Segments,_0.QueryArgs,_0.FormData,X,_0.Body))],Z)}):null;});return O.length==0?Q:k.Sum(u.append(O,[Q]));};o.JSUnion=function(L,M){var N;function O(S){var T;function U(V){return V!=null&&V.$==1&&z.Equals(S,V.$0);}T=u.tryFindIndex(function(V){return U(V[0]);},M);return T!=null&&T.$==1?T.$0:S.$;}function P(S,T){return x.init(x.length((x.get(M,S))[2]),function(U){return T["$"+r(U)];});}function Q(S,T){var U,V,W;U=L==null?{}:new L();V=x.get(M,S);return(W=V[0],W!=null&&W.$==1)?V[0].$0:(U.$=S,u.iteri(function(X,Y){U["$"+r(X)]=Y;},T),U);}function R(S,T){var U;function V(W,X){return[S,W,X,U];}U=T[2];return u.map(function(W){return V(W[0],W[1]);},T[1]);}N=x.ofSeq(u.collect(function(S){return R(S[0],S[1]);},u.indexed(M)));return i.New$1(function(S){function T(U,V,W,X){var Y,Z,_0;function _1(_2){return function(_3){return function(_4){var _5;function _6(_7,_8){return((_1(_5))(_7))(new t.T({$:1,$0:_8,$1:_4}));}return _2.$==1?(_5=_2.$1,u.collect(function(_7){return _6(_7[0],_7[1]);},_2.$0.Parse(_3))):[[_3,Q(U,x.ofList(t.rev(_4)))]];};};}return o.isCorrectMethod(V,S.Method)?(Y=h.startsWith(t.ofArray(W),S.Segments),Y==null?[]:(Z=Y.$0,(_0=t.ofArray(X),_0.$==0?[[g.New(Z,S.QueryArgs,S.FormData,S.Method,S.Body),Q(U,[])]]:((_1(_0))(g.New(Z,S.QueryArgs,S.FormData,S.Method,S.Body)))(t.T.Empty)))):[];}return u.collect(function(U){return T(U[0],U[1],U[2],U[3]);},N);},function(S){var T,U,V,W,X,Y;function Z(_0,_1){return _1.Write(_0);}T=O(S);U=x.get(M,T);V=U[2];W=x.get(U[1],0);X=[g.Segment(t.ofArray(W[1]),W[0])];return V.length==0?{$:1,$0:X}:(Y=(((s.Curried3(x.map2))(Z))(P(T,S)))(V),x.forall(function(_0){return _0!=null;},Y)?{$:1,$0:u.append(X,u.collect(function(_0){return _0.$0;},Y))}:null);});};o.isCorrectMethod=function(L,M){return M!=null&&M.$==1?L!=null&&L.$==1?z.Equals(M.$0,L.$0):true:!(L!=null&&L.$==1);};o.JSRecord=function(L,M){var N,O;function P(S){function T(U,V,W){var X;return V?(X=S[U],z.Equals(X,void 0)?null:{$:1,$0:X}):S[U];}return x.map(function(U){return T(U[0],U[1],U[2]);},M);}function Q(S){var T;function U(V,W,X){return function(Y){if(W){if(Y!=null&&Y.$==1)T[V]=Y.$0;}else T[V]=Y;};}T=L==null?{}:new L();(((s.Curried3(x.iter2))(function(V,W){return(function(X){return U(X[0],X[1],X[2]);}(V))(W);}))(M))(S);return T;}function R(S,T,U){return U;}N=x.map(function(S){return R(S[0],S[1],S[2]);},M);O=t.ofArray(N);return i.New$1(function(S){function T(U){return function(V){return function(W){var X;function Y(Z,_0){return((T(X))(Z))(new t.T({$:1,$0:_0,$1:W}));}return U.$==1?(X=U.$1,u.collect(function(Z){return Y(Z[0],Z[1]);},U.$0.Parse(V))):[[V,Q(x.ofList(t.rev(W)))]];};};}return((T(O))(S))(t.T.Empty);},function(S){var T;function U(V,W){return W.Write(V);}T=(((s.Curried3(x.map2))(U))(P(S)))(N);return x.forall(function(V){return V!=null;},T)?{$:1,$0:u.collect(function(V){return V.$0;},T)}:null;});};o.JSTuple=function(L){return o.Tuple(function(M){return x.init(x.length(L),function(N){return M[N];});},a.id,L);};o.Tuple=function(L,M,N){return i.New$1(function(O){function P(Q){return function(R){return function(S){var T;function U(V,W){return((P(T))(V))(new t.T({$:1,$0:W,$1:S}));}return Q.$==1?(T=Q.$1,u.collect(function(V){return U(V[0],V[1]);},Q.$0.Parse(R))):[[R,M(x.ofList(t.rev(S)))]];};};}return((P(t.ofArray(N)))(O))(t.T.Empty);},function(O){var P;function Q(R,S){return S.Write(R);}P=(((s.Curried3(x.map2))(Q))(L(O)))(N);return x.forall(function(R){return R!=null;},P)?{$:1,$0:u.collect(function(R){return R.$0;},P)}:null;});};o.rCors=function(L){return i.New$1(function(M){function N(O,P){var Q,R;return[O,s.DeleteEmptyFields({DefaultAllows:(Q=null,Q?Q.$0:void 0),EndPoint:(R={$:1,$0:P},R?R.$0:void 0)},["DefaultAllows","EndPoint"])];}return u.map(function(O){return N(O[0],O[1]);},L.Parse(M));},function(M){var N,O;N=(O=s.GetOptional(M.EndPoint),O==null?{$:1,$0:null}:{$:0,$0:O.$0});return N.$==1?{$:1,$0:[g.get_Empty()]}:L.Write(N.$0);});};o.rDateTime=function(){p.$cctor();return p.rDateTime;};o.rWildcardList=function(L){return i.New$1(function(M){function N(O){return function(P){function Q(R,S){return(N(R))(new t.T({$:1,$0:S,$1:P}));}return O.Segments.$==0?[[O,t.rev(P)]]:u.collect(function(R){return Q(R[0],R[1]);},L.Parse(O));};}return(N(M))(t.T.Empty);},function(M){var N;N=t.map(L.Write,M);return t.forAll(function(O){return O!=null;},N)?{$:1,$0:u.collect(function(O){return O.$0;},N)}:null;});};o.rWildcardArray=function(L){return i.New$1(function(M){function N(O){return function(P){function Q(R,S){return(N(R))(new t.T({$:1,$0:S,$1:P}));}return O.Segments.$==0?[[O,x.ofList(t.rev(P))]]:u.collect(function(R){return Q(R[0],R[1]);},L.Parse(O));};}return(N(M))(t.T.Empty);},function(M){var N;N=x.map(L.Write,M);return x.forall(function(O){return O!=null;},N)?{$:1,$0:u.collect(function(O){return O.$0;},N)}:null;});};o.rWildcard=function(){p.$cctor();return p.rWildcard;};o.rBool=function(){p.$cctor();return p.rBool;};o.rSingle=function(){p.$cctor();return p.rSingle;};o.rUInt64=function(){p.$cctor();return p.rUInt64;};o.rInt64=function(){p.$cctor();return p.rInt64;};o.rUInt=function(){p.$cctor();return p.rUInt;};o.rUInt16=function(){p.$cctor();return p.rUInt16;};o.rInt16=function(){p.$cctor();return p.rInt16;};o.rByte=function(){p.$cctor();return p.rByte;};o.rSByte=function(){p.$cctor();return p.rSByte;};o.rDouble=function(){p.$cctor();return p.rDouble;};o.rInt=function(){p.$cctor();return p.rInt;};o.rGuid=function(){p.$cctor();return p.rGuid;};o.rChar=function(){p.$cctor();return p.rChar;};o.rString=function(){p.$cctor();return p.rString;};o.rRoot=function(){p.$cctor();return p.rRoot;};p.$cctor=function(){p.$cctor=a.ignore;function L(M){var N,O;N=(O=0,[D.TryParseInt32(M,{get:function(){return O;},set:function(P){O=P;}}),O]);return N[0]?{$:1,$0:N[1]}:null;}p.Empty=i.New$1(function(){return[];},function(){return null;});p.rRoot=i.New(function(M){return[M];},[]);p.rString=i.New$1(function(M){var N,O;N=M.Segments;return N.$==0?[[M,""]]:(O=e.read(N.$0),O!=null&&O.$==1?[[g.New(N.$1,M.QueryArgs,M.FormData,M.Method,M.Body),O.$0]]:[]);},function(M){return{$:1,$0:[g.Segment$2(M==null?"null":e.write(M))]};});p.rChar=i.New$1(function(M){var N,O,P;N=M.Segments;return N.$==1?(O=e.read(N.$0),O!=null&&O.$==1&&(O.$0.length===1&&(P=O.$0,true))?[[g.New(N.$1,M.QueryArgs,M.FormData,M.Method,M.Body),H.Parse(P)]]:[]):[];},function(M){return{$:1,$0:[g.Segment$2(M)]};});p.rGuid=i.New$1(function(M){var N,O;N=M.Segments;return N.$==1?(O=null,J.TryParse(N.$0,{get:function(){return O;},set:function(P){O=P;}})?[[g.New(N.$1,M.QueryArgs,M.FormData,M.Method,M.Body),O]]:[]):[];},function(M){return{$:1,$0:[g.Segment$2(r(M))]};});p.rInt=i.New$1(function(M){var N,O;N=M.Segments;return N.$==1?(O=0,D.TryParseInt32(N.$0,{get:function(){return O;},set:function(P){O=P;}})?[[g.New(N.$1,M.QueryArgs,M.FormData,M.Method,M.Body),O]]:[]):[];},function(M){return{$:1,$0:[g.Segment$2(r(M))]};});p.rDouble=i.New$1(function(M){var N,O,P;N=M.Segments;return N.$==1?(O=0,(P=a.Number(N.$0),a.isNaN(P)?false:(O=P,true))?[[g.New(N.$1,M.QueryArgs,M.FormData,M.Method,M.Body),O]]:[]):[];},function(M){return{$:1,$0:[g.Segment$2(r(M))]};});p.rSByte=i.New$1(function(M){var N,O;N=M.Segments;return N.$==1?(O=0,D.TryParseSByte(N.$0,{get:function(){return O;},set:function(P){O=P;}})?[[g.New(N.$1,M.QueryArgs,M.FormData,M.Method,M.Body),O]]:[]):[];},function(M){return{$:1,$0:[g.Segment$2(r(M))]};});p.rByte=i.New$1(function(M){var N,O;N=M.Segments;return N.$==1?(O=0,D.TryParseByte(N.$0,{get:function(){return O;},set:function(P){O=P;}})?[[g.New(N.$1,M.QueryArgs,M.FormData,M.Method,M.Body),O]]:[]):[];},function(M){return{$:1,$0:[g.Segment$2(r(M))]};});p.rInt16=i.New$1(function(M){var N,O;N=M.Segments;return N.$==1?(O=0,D.TryParseInt16(N.$0,{get:function(){return O;},set:function(P){O=P;}})?[[g.New(N.$1,M.QueryArgs,M.FormData,M.Method,M.Body),O]]:[]):[];},function(M){return{$:1,$0:[g.Segment$2(r(M))]};});p.rUInt16=i.New$1(function(M){var N,O;N=M.Segments;return N.$==1?(O=0,D.TryParseUInt16(N.$0,{get:function(){return O;},set:function(P){O=P;}})?[[g.New(N.$1,M.QueryArgs,M.FormData,M.Method,M.Body),O]]:[]):[];},function(M){return{$:1,$0:[g.Segment$2(r(M))]};});p.rUInt=i.New$1(function(M){var N,O;N=M.Segments;return N.$==1?(O=0,D.TryParseUInt32(N.$0,{get:function(){return O;},set:function(P){O=P;}})?[[g.New(N.$1,M.QueryArgs,M.FormData,M.Method,M.Body),O]]:[]):[];},function(M){return{$:1,$0:[g.Segment$2(r(M))]};});p.rInt64=i.New$1(function(M){var N,O;N=M.Segments;return N.$==1?(O=0,D.TryParseInt64(N.$0,{get:function(){return O;},set:function(P){O=P;}})?[[g.New(N.$1,M.QueryArgs,M.FormData,M.Method,M.Body),O]]:[]):[];},function(M){return{$:1,$0:[g.Segment$2(r(M))]};});p.rUInt64=i.New$1(function(M){var N,O;N=M.Segments;return N.$==1?(O=0,D.TryParseUInt64(N.$0,{get:function(){return O;},set:function(P){O=P;}})?[[g.New(N.$1,M.QueryArgs,M.FormData,M.Method,M.Body),O]]:[]):[];},function(M){return{$:1,$0:[g.Segment$2(r(M))]};});p.rSingle=i.New$1(function(M){var N,O,P;N=M.Segments;return N.$==1?(O=0,(P=a.Number(N.$0),a.isNaN(P)?false:(O=P,true))?[[g.New(N.$1,M.QueryArgs,M.FormData,M.Method,M.Body),O]]:[]):[];},function(M){return{$:1,$0:[g.Segment$2(r(M))]};});p.rBool=i.New$1(function(M){var N,O,P;N=M.Segments;return N.$==1?(O=(P=null,[D.TryParseBool(N.$0,{get:function(){return P;},set:function(Q){P=Q;}}),P]),O[0]?[[g.New(N.$1,M.QueryArgs,M.FormData,M.Method,M.Body),O[1]]]:[]):[];},function(M){return{$:1,$0:[g.Segment$2(M?"True":"False")]};});p.rWildcard=i.New$1(function(M){return[[g.New(t.T.Empty,M.QueryArgs,M.FormData,M.Method,M.Body),q.concat("/",M.Segments)]];},function(M){return{$:1,$0:[g.Segment$2(M)]};});p.rDateTime=i.New$1(function(M){var N,O,P,Q,R,S,T,U,V;N=M.Segments;return N.$==1?(O=N.$0,O.length===19&&O[4]==="-"&&O[7]==="-"&&O[10]==="-"&&O[13]==="."&&O[16]==="."?(P=L(K.string(O,{$:1,$0:0},{$:1,$0:3})),(Q=L(K.string(O,{$:1,$0:5},{$:1,$0:6})),(R=L(K.string(O,{$:1,$0:8},{$:1,$0:9})),(S=L(K.string(O,{$:1,$0:11},{$:1,$0:12})),(T=L(K.string(O,{$:1,$0:14},{$:1,$0:15})),(U=L(K.string(O,{$:1,$0:17},{$:1,$0:18})),P!=null&&P.$==1&&(Q!=null&&Q.$==1&&(R!=null&&R.$==1&&(S!=null&&S.$==1&&(T!=null&&T.$==1&&(U!=null&&U.$==1&&(V=[R.$0,S.$0,Q.$0,T.$0,U.$0,P.$0],true))))))?[[g.New(N.$1,M.QueryArgs,M.FormData,M.Method,M.Body),(new a.Date(V[5],V[2]-1,V[0],V[1],V[3],V[4])).getTime()]]:[])))))):[]):[];},function(M){var N,O;function P(Q){var R;R=r(Q);return R.length===1?"0"+R:R;}return{$:1,$0:[g.Segment$2((N=r((new a.Date(M)).getFullYear()),(O=N.length,O===1?"000"+N:O===2?"00"+N:O===3?"0"+N:N))+"-"+P((new a.Date(M)).getMonth()+1)+"-"+P((new a.Date(M)).getDate())+"-"+P((new a.Date(M)).getHours())+"."+P((new a.Date(M)).getMinutes())+"."+P((new a.Date(M)).getSeconds()))]};});};}(self));
