(function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G;b=a.WebSharper=a.WebSharper||{};c=b.UI=b.UI||{};d=c.Templating=c.Templating||{};e=d.Runtime=d.Runtime||{};f=e.Server=e.Server||{};g=f.TemplateInitializer=f.TemplateInitializer||{};h=b&&b.Obj;i=f.TemplateInstances=f.TemplateInstances||{};j=f.Handler=f.Handler||{};k=f.ProviderBuilder=f.ProviderBuilder||{};l=f.TemplateInstance=f.TemplateInstance||{};m=e.Client=e.Client||{};n=b&&b.Collections;o=n&&n.Dictionary;p=b&&b.Runtime;q=b&&b.Arrays;r=b&&b.Unchecked;s=c&&c.Var$1;t=b&&b.Operators;u=c&&c.Doc;v=c&&c.Client;w=v&&v.Templates;x=b&&b.Slice;y=c&&c.BindVar;z=a.console;A=c&&c.View;B=b&&b.Activator;C=n&&n.HashSet;D=b&&b.Enumerator;E=b&&b.Seq;F=a.System;G=F&&F.Guid;g.$cctor=function(){g.$cctor=a.ignore;g.initialized=new o.New$5();};g=f.TemplateInitializer=p.Class({get_Vars:function(){g.$cctor();return this.vars;},get_Id:function(){g.$cctor();return this.id;},InitInstance:function(H){var I,J,K,L,M,N,O,P;g.$cctor();J=g.GetHolesFor(H);K=this.vars;for(L=0,M=K.length-1;L<=M;L++){N=q.get(K,L);O=N[1];P=N[0];if(!J.ContainsKey(P))J.set_Item(P,r.Equals(O,0)?{$:8,$0:P,$1:s.Create$1("")}:r.Equals(O,1)?{$:13,$0:P,$1:s.Create$1(0)}:r.Equals(O,2)?{$:9,$0:P,$1:s.Create$1(false)}:t.FailWith("Invalid value type"));}this.instance=new l.New({$:0,$0:J},u.get_Empty());},get_Instance:function(){g.$cctor();return p.GetOptional(this.instance).$0;},$postinit:function(H){g.$cctor();w.RunFullDocTemplate([]);},$init:function(H){g.$cctor();},$preinit:function(H){var I,J,K,L,M,N,O,P;g.$cctor();this.InitInstance(H);I=self.document.querySelectorAll("[ws-var^='"+H+"::']");for(J=0,K=I.length-1;J<=K;J++){L=I[J];M=L.getAttribute("ws-var");N=x.string(M,{$:1,$0:H.length+2},null);O=this.get_Instance().Hole(N);P={$:O.$,$0:M,$1:O.$1};w.GlobalHoles().set_Item(P.$0,P);g.applyVarHole(L,O);}}},h,g);g.applyVarHole=function(H,I){var J;g.$cctor();switch(I.$==9?1:I.$==10?2:I.$==11?3:I.$==12?4:I.$==13?5:I.$==0?(J=I.$0,6):I.$==1?(J=I.$0,6):I.$==2?(J=I.$0,6):I.$==14?(J=I.$0,6):I.$==4?(J=I.$0,6):I.$==5?(J=I.$0,6):I.$==6?(J=I.$0,6):I.$==7?(J=I.$0,6):I.$==3?(J=I.$0,6):0){case 0:g.applyTypedVarHole(y.StringApply(),I.$1,H);break;case 1:g.applyTypedVarHole(y.BoolCheckedApply(),I.$1,H);break;case 2:g.applyTypedVarHole(y.IntApplyChecked(),I.$1,H);break;case 3:g.applyTypedVarHole(y.IntApplyUnchecked(),I.$1,H);break;case 4:g.applyTypedVarHole(y.FloatApplyChecked(),I.$1,H);break;case 5:g.applyTypedVarHole(y.FloatApplyUnchecked(),I.$1,H);break;case 6:z.warn("Not a var hole: ",J);break;}};g.applyTypedVarHole=function(H,I,J){var K;g.$cctor();K=H(I);K[0](J);A.Sink(K[1](J),K[2]);};g.GetOrAddHoleFor=function(H,I,J){var K,L,M,N;g.$cctor();K=g.GetHolesFor(H);L=(M=null,[K.TryGetValue(I,{get:function(){return M;},set:function(O){M=O;}}),M]);return L[0]?L[1]:(N=J(),(K.set_Item(I,N),N));};g.GetHolesFor=function(H){var I,J,K;g.$cctor();I=(J=null,[g.initialized.TryGetValue(H,{get:function(){return J;},set:function(L){J=L;}}),J]);return I[0]?I[1]:(K=new o.New$5(),(g.initialized.set_Item(H,K),K));};g.get_Initialized=function(){g.$cctor();return g.initialized;};g.New=p.Ctor(function(H,I){g.$cctor();h.New.call(this);this.vars=I;p.SetOptional(this,"instance",null);this.id=H;},g);i=f.TemplateInstances=p.Class({},h,i);i.GetInstance=function(H){return(B.Instances())[H].get_Instance();};i.New=p.Ctor(function(){h.New.call(this);},i);j.AfterRenderQ2$203$42=function(H,I){return function(J){I({Vars:i.GetInstance(H),Target:J,Event:null});};};j.EventQ2$189$36=function(H,I){return function(J){return function(K){return I({Vars:i.GetInstance(H),Target:J,Event:K});};};};j.CompleteHoles=function(H,I,J){var L,M,N,O,P;function K(Q,R){var S;return M.Contains(Q)?null:(S=r.Equals(R,0)?g.GetOrAddHoleFor(H,Q,function(){return{$:8,$0:Q,$1:s.Create$1("")};}):r.Equals(R,1)?g.GetOrAddHoleFor(H,Q,function(){return{$:13,$0:Q,$1:s.Create$1(0)};}):r.Equals(R,2)?g.GetOrAddHoleFor(H,Q,function(){return{$:9,$0:Q,$1:s.Create$1(false)};}):t.FailWith("Invalid value type"),(L.set_Item(Q,S),{$:1,$0:S}));}L=new o.New$5();M=new C.New$3();N=D.Get(I);try{while(N.MoveNext()){O=N.Current();P=O.$0;M.SAdd(P);L.set_Item(P,O);}}finally{if(typeof N=="object"&&"Dispose"in N)N.Dispose();}return[E.append(I,q.choose(function(Q){return K(Q[0],Q[1]);},J)),{$:0,$0:L}];};j.AfterRenderQ2=function(H,I,J,K){return{$:7,$0:I,$1:function(L){K({Vars:J(),Target:L,Event:null});}};};j.EventQ2=function(H,I,J,K){return{$:5,$0:I,$1:function(L){return function(M){return K({Vars:J(),Target:L,Event:M});};}};};k=f.ProviderBuilder=p.Class({},h,k);k.New=p.Ctor(function(H){var I;h.New.call(this);this.i=null;this.k=(I=G.NewGuid(),a.String(I));this.h=p.MarkResizable([]);this.s=H;},k);k.New$1=p.Ctor(function(){var H;h.New.call(this);this.i=null;this.k=(H=G.NewGuid(),a.String(H));this.h=p.MarkResizable([]);p.SetOptional(this,"s",null);},k);l=f.TemplateInstance=p.Class({Hole:function(H){return this.allVars.Item(H);},get_Doc:function(){return this.doc;}},h,l);l.New=p.Ctor(function(H,I){h.New.call(this);this.doc=I;this.allVars=H.$==0?H.$0:t.FailWith("Should not happen");},l);m.AfterRenderQ2$57$26=function(H){return function(){H();};};m.Box=a.id;}(self));
